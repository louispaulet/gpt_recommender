import{r as D,j as p,S as Kn,R as Ms}from"./index-Ch2rTMIX.js";const On="RFC3986",Tn={RFC1738:s=>String(s).replace(/%20/g,"+"),RFC3986:s=>String(s)},ri="RFC1738",ai=Array.isArray,ge=(()=>{const s=[];for(let e=0;e<256;++e)s.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return s})(),yn=1024,ii=(s,e,t,n,r)=>{if(s.length===0)return s;let a=s;if(typeof s=="symbol"?a=Symbol.prototype.toString.call(s):typeof s!="string"&&(a=String(s)),t==="iso-8859-1")return escape(a).replace(/%u[0-9a-f]{4}/gi,function(o){return"%26%23"+parseInt(o.slice(2),16)+"%3B"});let i="";for(let o=0;o<a.length;o+=yn){const c=a.length>=yn?a.slice(o,o+yn):a,l=[];for(let u=0;u<c.length;++u){let h=c.charCodeAt(u);if(h===45||h===46||h===95||h===126||h>=48&&h<=57||h>=65&&h<=90||h>=97&&h<=122||r===ri&&(h===40||h===41)){l[l.length]=c.charAt(u);continue}if(h<128){l[l.length]=ge[h];continue}if(h<2048){l[l.length]=ge[192|h>>6]+ge[128|h&63];continue}if(h<55296||h>=57344){l[l.length]=ge[224|h>>12]+ge[128|h>>6&63]+ge[128|h&63];continue}u+=1,h=65536+((h&1023)<<10|c.charCodeAt(u)&1023),l[l.length]=ge[240|h>>18]+ge[128|h>>12&63]+ge[128|h>>6&63]+ge[128|h&63]}i+=l.join("")}return i};function oi(s){return!s||typeof s!="object"?!1:!!(s.constructor&&s.constructor.isBuffer&&s.constructor.isBuffer(s))}function Ls(s,e){if(ai(s)){const t=[];for(let n=0;n<s.length;n+=1)t.push(e(s[n]));return t}return e(s)}const ci=Object.prototype.hasOwnProperty,Cr={brackets(s){return String(s)+"[]"},comma:"comma",indices(s,e){return String(s)+"["+e+"]"},repeat(s){return String(s)}},ye=Array.isArray,li=Array.prototype.push,Pr=function(s,e){li.apply(s,ye(e)?e:[e])},ui=Date.prototype.toISOString,G={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:ii,encodeValuesOnly:!1,format:On,formatter:Tn[On],indices:!1,serializeDate(s){return ui.call(s)},skipNulls:!1,strictNullHandling:!1};function di(s){return typeof s=="string"||typeof s=="number"||typeof s=="boolean"||typeof s=="symbol"||typeof s=="bigint"}const _n={};function Rr(s,e,t,n,r,a,i,o,c,l,u,h,d,y,_,w,x,V){let g=s,A=V,C=0,F=!1;for(;(A=A.get(_n))!==void 0&&!F;){const W=A.get(s);if(C+=1,typeof W<"u"){if(W===C)throw new RangeError("Cyclic object value");F=!0}typeof A.get(_n)>"u"&&(C=0)}if(typeof l=="function"?g=l(e,g):g instanceof Date?g=d==null?void 0:d(g):t==="comma"&&ye(g)&&(g=Ls(g,function(W){return W instanceof Date?d==null?void 0:d(W):W})),g===null){if(a)return c&&!w?c(e,G.encoder,x,"key",y):e;g=""}if(di(g)||oi(g)){if(c){const W=w?e:c(e,G.encoder,x,"key",y);return[(_==null?void 0:_(W))+"="+(_==null?void 0:_(c(g,G.encoder,x,"value",y)))]}return[(_==null?void 0:_(e))+"="+(_==null?void 0:_(String(g)))]}const N=[];if(typeof g>"u")return N;let T;if(t==="comma"&&ye(g))w&&c&&(g=Ls(g,c)),T=[{value:g.length>0?g.join(",")||null:void 0}];else if(ye(l))T=l;else{const W=Object.keys(g);T=u?W.sort(u):W}const se=o?String(e).replace(/\./g,"%2E"):String(e),H=n&&ye(g)&&g.length===1?se+"[]":se;if(r&&ye(g)&&g.length===0)return H+"[]";for(let W=0;W<T.length;++W){const Z=T[W],I=typeof Z=="object"&&typeof Z.value<"u"?Z.value:g[Z];if(i&&I===null)continue;const q=h&&o?Z.replace(/\./g,"%2E"):Z,Be=ye(g)?typeof t=="function"?t(H,q):H:H+(h?"."+q:"["+q+"]");V.set(s,C);const Ue=new WeakMap;Ue.set(_n,V),Pr(N,Rr(I,Be,t,n,r,a,i,o,t==="comma"&&w&&ye(g)?null:c,l,u,h,d,y,_,w,x,Ue))}return N}function hi(s=G){if(typeof s.allowEmptyArrays<"u"&&typeof s.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof s.encodeDotInKeys<"u"&&typeof s.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(s.encoder!==null&&typeof s.encoder<"u"&&typeof s.encoder!="function")throw new TypeError("Encoder has to be a function.");const e=s.charset||G.charset;if(typeof s.charset<"u"&&s.charset!=="utf-8"&&s.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let t=On;if(typeof s.format<"u"){if(!ci.call(Tn,s.format))throw new TypeError("Unknown format option provided.");t=s.format}const n=Tn[t];let r=G.filter;(typeof s.filter=="function"||ye(s.filter))&&(r=s.filter);let a;if(s.arrayFormat&&s.arrayFormat in Cr?a=s.arrayFormat:"indices"in s?a=s.indices?"indices":"repeat":a=G.arrayFormat,"commaRoundTrip"in s&&typeof s.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const i=typeof s.allowDots>"u"?s.encodeDotInKeys?!0:G.allowDots:!!s.allowDots;return{addQueryPrefix:typeof s.addQueryPrefix=="boolean"?s.addQueryPrefix:G.addQueryPrefix,allowDots:i,allowEmptyArrays:typeof s.allowEmptyArrays=="boolean"?!!s.allowEmptyArrays:G.allowEmptyArrays,arrayFormat:a,charset:e,charsetSentinel:typeof s.charsetSentinel=="boolean"?s.charsetSentinel:G.charsetSentinel,commaRoundTrip:!!s.commaRoundTrip,delimiter:typeof s.delimiter>"u"?G.delimiter:s.delimiter,encode:typeof s.encode=="boolean"?s.encode:G.encode,encodeDotInKeys:typeof s.encodeDotInKeys=="boolean"?s.encodeDotInKeys:G.encodeDotInKeys,encoder:typeof s.encoder=="function"?s.encoder:G.encoder,encodeValuesOnly:typeof s.encodeValuesOnly=="boolean"?s.encodeValuesOnly:G.encodeValuesOnly,filter:r,format:t,formatter:n,serializeDate:typeof s.serializeDate=="function"?s.serializeDate:G.serializeDate,skipNulls:typeof s.skipNulls=="boolean"?s.skipNulls:G.skipNulls,sort:typeof s.sort=="function"?s.sort:null,strictNullHandling:typeof s.strictNullHandling=="boolean"?s.strictNullHandling:G.strictNullHandling}}function fi(s,e={}){let t=s;const n=hi(e);let r,a;typeof n.filter=="function"?(a=n.filter,t=a("",t)):ye(n.filter)&&(a=n.filter,r=a);const i=[];if(typeof t!="object"||t===null)return"";const o=Cr[n.arrayFormat],c=o==="comma"&&n.commaRoundTrip;r||(r=Object.keys(t)),n.sort&&r.sort(n.sort);const l=new WeakMap;for(let d=0;d<r.length;++d){const y=r[d];n.skipNulls&&t[y]===null||Pr(i,Rr(t[y],y,o,c,n.allowEmptyArrays,n.strictNullHandling,n.skipNulls,n.encodeDotInKeys,n.encode?n.encoder:null,n.filter,n.sort,n.allowDots,n.serializeDate,n.format,n.formatter,n.encodeValuesOnly,n.charset,l))}const u=i.join(n.delimiter);let h=n.addQueryPrefix===!0?"?":"";return n.charsetSentinel&&(n.charset==="iso-8859-1"?h+="utf8=%26%2310003%3B&":h+="utf8=%E2%9C%93&"),u.length>0?h+u:""}const He="4.104.0";let Fs=!1,pt,Er,Or,$n,Tr,$r,Ir,Nr,jr;function mi(s,e={auto:!1}){if(Fs)throw new Error(`you must \`import 'openai/shims/${s.kind}'\` before importing anything else from openai`);if(pt)throw new Error(`can't \`import 'openai/shims/${s.kind}'\` after \`import 'openai/shims/${pt}'\``);Fs=e.auto,pt=s.kind,Er=s.fetch,Or=s.FormData,$n=s.File,Tr=s.ReadableStream,$r=s.getMultipartRequestOptions,Ir=s.getDefaultAgent,Nr=s.fileFromPath,jr=s.isFsReadStream}class pi{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}function gi({manuallyImported:s}={}){const e=s?"You may need to use polyfills":"Add one of these imports before your first `import â€¦ from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let t,n,r,a;try{t=fetch,n=Request,r=Response,a=Headers}catch(i){throw new Error(`this environment is missing the following Web Fetch API type: ${i.message}. ${e}`)}return{kind:"web",fetch:t,Request:n,Response:r,Headers:a,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:async(i,o)=>({...o,body:new pi(i)}),getDefaultAgent:i=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:i=>!1}}const Mr=()=>{pt||mi(gi(),{auto:!0})};Mr();class P extends Error{}class te extends P{constructor(e,t,n,r){super(`${te.makeMessage(e,t,n)}`),this.status=e,this.headers=r,this.request_id=r==null?void 0:r["x-request-id"],this.error=t;const a=t;this.code=a==null?void 0:a.code,this.param=a==null?void 0:a.param,this.type=a==null?void 0:a.type}static makeMessage(e,t,n){const r=t!=null&&t.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):n;return e&&r?`${e} ${r}`:e?`${e} status code (no body)`:r||"(no status code or body)"}static generate(e,t,n,r){if(!e||!r)return new nn({message:n,cause:Nn(t)});const a=t==null?void 0:t.error;return e===400?new Lr(e,a,n,r):e===401?new Fr(e,a,n,r):e===403?new Dr(e,a,n,r):e===404?new Zr(e,a,n,r):e===409?new Br(e,a,n,r):e===422?new Ur(e,a,n,r):e===429?new Vr(e,a,n,r):e>=500?new Wr(e,a,n,r):new te(e,a,n,r)}}class le extends te{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class nn extends te{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class Gn extends nn{constructor({message:e}={}){super({message:e??"Request timed out."})}}class Lr extends te{}class Fr extends te{}class Dr extends te{}class Zr extends te{}class Br extends te{}class Ur extends te{}class Vr extends te{}class Wr extends te{}class zr extends P{constructor(){super("Could not parse response content as the length limit was reached")}}class Jr extends P{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}var Et=function(s,e,t,n,r){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?s!==e||!r:!e.has(s))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?r.call(s,t):r?r.value=t:e.set(s,t),t},je=function(s,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?s!==e||!n:!e.has(s))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(s):n?n.value:e.get(s)},ie;class sn{constructor(){ie.set(this,void 0),this.buffer=new Uint8Array,Et(this,ie,null,"f")}decode(e){if(e==null)return[];const t=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?new TextEncoder().encode(e):e;let n=new Uint8Array(this.buffer.length+t.length);n.set(this.buffer),n.set(t,this.buffer.length),this.buffer=n;const r=[];let a;for(;(a=yi(this.buffer,je(this,ie,"f")))!=null;){if(a.carriage&&je(this,ie,"f")==null){Et(this,ie,a.index,"f");continue}if(je(this,ie,"f")!=null&&(a.index!==je(this,ie,"f")+1||a.carriage)){r.push(this.decodeText(this.buffer.slice(0,je(this,ie,"f")-1))),this.buffer=this.buffer.slice(je(this,ie,"f")),Et(this,ie,null,"f");continue}const i=je(this,ie,"f")!==null?a.preceding-1:a.preceding,o=this.decodeText(this.buffer.slice(0,i));r.push(o),this.buffer=this.buffer.slice(a.index),Et(this,ie,null,"f")}return r}decodeText(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof Buffer<"u"){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new P(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new P(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new P("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){return this.buffer.length?this.decode(`
`):[]}}ie=new WeakMap;sn.NEWLINE_CHARS=new Set([`
`,"\r"]);sn.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function yi(s,e){for(let r=e??0;r<s.length;r++){if(s[r]===10)return{preceding:r,index:r+1,carriage:!1};if(s[r]===13)return{preceding:r,index:r+1,carriage:!0}}return null}function _i(s){for(let n=0;n<s.length-1;n++){if(s[n]===10&&s[n+1]===10||s[n]===13&&s[n+1]===13)return n+2;if(s[n]===13&&s[n+1]===10&&n+3<s.length&&s[n+2]===13&&s[n+3]===10)return n+4}return-1}function Hr(s){if(s[Symbol.asyncIterator])return s;const e=s.getReader();return{async next(){try{const t=await e.read();return t!=null&&t.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}class be{constructor(e,t){this.iterator=e,this.controller=t}static fromSSEResponse(e,t){let n=!1;async function*r(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let a=!1;try{for await(const i of bi(e,t))if(!a){if(i.data.startsWith("[DONE]")){a=!0;continue}if(i.event===null||i.event.startsWith("response.")||i.event.startsWith("transcript.")){let o;try{o=JSON.parse(i.data)}catch(c){throw console.error("Could not parse message into JSON:",i.data),console.error("From chunk:",i.raw),c}if(o&&o.error)throw new te(void 0,o.error,void 0,ea(e.headers));yield o}else{let o;try{o=JSON.parse(i.data)}catch(c){throw console.error("Could not parse message into JSON:",i.data),console.error("From chunk:",i.raw),c}if(i.event=="error")throw new te(void 0,o.error,o.message,void 0);yield{event:i.event,data:o}}}a=!0}catch(i){if(i instanceof Error&&i.name==="AbortError")return;throw i}finally{a||t.abort()}}return new be(r,t)}static fromReadableStream(e,t){let n=!1;async function*r(){const i=new sn,o=Hr(e);for await(const c of o)for(const l of i.decode(c))yield l;for(const c of i.flush())yield c}async function*a(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let i=!1;try{for await(const o of r())i||o&&(yield JSON.parse(o));i=!0}catch(o){if(o instanceof Error&&o.name==="AbortError")return;throw o}finally{i||t.abort()}}return new be(a,t)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],n=this.iterator(),r=a=>({next:()=>{if(a.length===0){const i=n.next();e.push(i),t.push(i)}return a.shift()}});return[new be(()=>r(e),this.controller),new be(()=>r(t),this.controller)]}toReadableStream(){const e=this;let t;const n=new TextEncoder;return new Tr({async start(){t=e[Symbol.asyncIterator]()},async pull(r){try{const{value:a,done:i}=await t.next();if(i)return r.close();const o=n.encode(JSON.stringify(a)+`
`);r.enqueue(o)}catch(a){r.error(a)}},async cancel(){var r;await((r=t.return)==null?void 0:r.call(t))}})}}async function*bi(s,e){if(!s.body)throw e.abort(),new P("Attempted to iterate over a response with no body");const t=new xi,n=new sn,r=Hr(s.body);for await(const a of wi(r))for(const i of n.decode(a)){const o=t.decode(i);o&&(yield o)}for(const a of n.flush()){const i=t.decode(a);i&&(yield i)}}async function*wi(s){let e=new Uint8Array;for await(const t of s){if(t==null)continue;const n=t instanceof ArrayBuffer?new Uint8Array(t):typeof t=="string"?new TextEncoder().encode(t):t;let r=new Uint8Array(e.length+n.length);r.set(e),r.set(n,e.length),e=r;let a;for(;(a=_i(e))!==-1;)yield e.slice(0,a),e=e.slice(a)}e.length>0&&(yield e)}class xi{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const a={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],a}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,n,r]=vi(e,":");return r.startsWith(" ")&&(r=r.substring(1)),t==="event"?this.event=r:t==="data"&&this.data.push(r),null}}function vi(s,e){const t=s.indexOf(e);return t!==-1?[s.substring(0,t),e,s.substring(t+e.length)]:[s,"",""]}const qr=s=>s!=null&&typeof s=="object"&&typeof s.url=="string"&&typeof s.blob=="function",Xr=s=>s!=null&&typeof s=="object"&&typeof s.name=="string"&&typeof s.lastModified=="number"&&rn(s),rn=s=>s!=null&&typeof s=="object"&&typeof s.size=="number"&&typeof s.type=="string"&&typeof s.text=="function"&&typeof s.slice=="function"&&typeof s.arrayBuffer=="function",ki=s=>Xr(s)||qr(s)||jr(s);async function Kr(s,e,t){var r;if(s=await s,Xr(s))return s;if(qr(s)){const a=await s.blob();e||(e=new URL(s.url).pathname.split(/[\\/]/).pop()??"unknown_file");const i=rn(a)?[await a.arrayBuffer()]:[a];return new $n(i,e,t)}const n=await Si(s);if(e||(e=Ci(s)??"unknown_file"),!(t!=null&&t.type)){const a=(r=n[0])==null?void 0:r.type;typeof a=="string"&&(t={...t,type:a})}return new $n(n,e,t)}async function Si(s){var t;let e=[];if(typeof s=="string"||ArrayBuffer.isView(s)||s instanceof ArrayBuffer)e.push(s);else if(rn(s))e.push(await s.arrayBuffer());else if(Pi(s))for await(const n of s)e.push(n);else throw new Error(`Unexpected data type: ${typeof s}; constructor: ${(t=s==null?void 0:s.constructor)==null?void 0:t.name}; props: ${Ai(s)}`);return e}function Ai(s){return`[${Object.getOwnPropertyNames(s).map(t=>`"${t}"`).join(", ")}]`}function Ci(s){var e;return bn(s.name)||bn(s.filename)||((e=bn(s.path))==null?void 0:e.split(/[\\/]/).pop())}const bn=s=>{if(typeof s=="string")return s;if(typeof Buffer<"u"&&s instanceof Buffer)return String(s)},Pi=s=>s!=null&&typeof s=="object"&&typeof s[Symbol.asyncIterator]=="function",Ds=s=>s&&typeof s=="object"&&s.body&&s[Symbol.toStringTag]==="MultipartBody",De=async s=>{const e=await Ri(s.body);return $r(e,s)},Ri=async s=>{const e=new Or;return await Promise.all(Object.entries(s||{}).map(([t,n])=>In(e,t,n))),e},In=async(s,e,t)=>{if(t!==void 0){if(t==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof t=="string"||typeof t=="number"||typeof t=="boolean")s.append(e,String(t));else if(ki(t)){const n=await Kr(t);s.append(e,n)}else if(Array.isArray(t))await Promise.all(t.map(n=>In(s,e+"[]",n)));else if(typeof t=="object")await Promise.all(Object.entries(t).map(([n,r])=>In(s,`${e}[${n}]`,r)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${t} instead`)}};var Ye={},Ei=function(s,e,t,n,r){if(typeof e=="function"?s!==e||!0:!e.has(s))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(s,t),t},Oi=function(s,e,t,n){if(typeof e=="function"?s!==e||!0:!e.has(s))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(s):n?n.value:e.get(s)},Ot;Mr();async function Gr(s){var i;const{response:e}=s;if(s.options.stream)return Ee("response",e.status,e.url,e.headers,e.body),s.options.__streamClass?s.options.__streamClass.fromSSEResponse(e,s.controller):be.fromSSEResponse(e,s.controller);if(e.status===204)return null;if(s.options.__binaryResponse)return e;const t=e.headers.get("content-type"),n=(i=t==null?void 0:t.split(";")[0])==null?void 0:i.trim();if((n==null?void 0:n.includes("application/json"))||(n==null?void 0:n.endsWith("+json"))){const o=await e.json();return Ee("response",e.status,e.url,e.headers,o),Yr(o,e)}const a=await e.text();return Ee("response",e.status,e.url,e.headers,a),a}function Yr(s,e){return!s||typeof s!="object"||Array.isArray(s)?s:Object.defineProperty(s,"_request_id",{value:e.headers.get("x-request-id"),enumerable:!1})}class an extends Promise{constructor(e,t=Gr){super(n=>{n(null)}),this.responsePromise=e,this.parseResponse=t}_thenUnwrap(e){return new an(this.responsePromise,async t=>Yr(e(await this.parseResponse(t),t),t.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t,request_id:t.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class Ti{constructor({baseURL:e,maxRetries:t=2,timeout:n=6e5,httpAgent:r,fetch:a}){this.baseURL=e,this.maxRetries=wn("maxRetries",t),this.timeout=wn("timeout",n),this.httpAgent=r,this.fetch=a??Er}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...Mi(),...this.authHeaders(e)}}validateHeaders(e,t){}defaultIdempotencyKey(){return`stainless-node-retry-${Zi()}`}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,n){return this.request(Promise.resolve(n).then(async r=>{const a=r&&rn(r==null?void 0:r.body)?new DataView(await r.body.arrayBuffer()):(r==null?void 0:r.body)instanceof DataView?r.body:(r==null?void 0:r.body)instanceof ArrayBuffer?new DataView(r.body):r&&ArrayBuffer.isView(r==null?void 0:r.body)?new DataView(r.body.buffer):r==null?void 0:r.body;return{method:e,path:t,...r,body:a}}))}getAPIList(e,t,n){return this.requestAPIList(t,{method:"get",path:e,...n})}calculateContentLength(e){if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.byteLength(e,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(e).length.toString()}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e,{retryCount:t=0}={}){var w;const n={...e},{method:r,path:a,query:i,headers:o={}}=n,c=ArrayBuffer.isView(n.body)||n.__binaryRequest&&typeof n.body=="string"?n.body:Ds(n.body)?n.body.body:n.body?JSON.stringify(n.body,null,2):null,l=this.calculateContentLength(c),u=this.buildURL(a,i);"timeout"in n&&wn("timeout",n.timeout),n.timeout=n.timeout??this.timeout;const h=n.httpAgent??this.httpAgent??Ir(u),d=n.timeout+1e3;typeof((w=h==null?void 0:h.options)==null?void 0:w.timeout)=="number"&&d>(h.options.timeout??0)&&(h.options.timeout=d),this.idempotencyHeader&&r!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),o[this.idempotencyHeader]=e.idempotencyKey);const y=this.buildHeaders({options:n,headers:o,contentLength:l,retryCount:t});return{req:{method:r,...c&&{body:c},headers:y,...h&&{agent:h},signal:n.signal??null},url:u,timeout:n.timeout}}buildHeaders({options:e,headers:t,contentLength:n,retryCount:r}){const a={};n&&(a["content-length"]=n);const i=this.defaultHeaders(e);return Vs(a,i),Vs(a,t),Ds(e.body)&&pt!=="node"&&delete a["content-type"],$t(i,"x-stainless-retry-count")===void 0&&$t(t,"x-stainless-retry-count")===void 0&&(a["x-stainless-retry-count"]=String(r)),$t(i,"x-stainless-timeout")===void 0&&$t(t,"x-stainless-timeout")===void 0&&e.timeout&&(a["x-stainless-timeout"]=String(Math.trunc(e.timeout/1e3))),this.validateHeaders(a,t),a}async prepareOptions(e){}async prepareRequest(e,{url:t,options:n}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(t=>[...t])):{...e}:{}}makeStatusError(e,t,n,r){return te.generate(e,t,n,r)}request(e,t=null){return new an(this.makeRequest(e,t))}async makeRequest(e,t){var h,d;const n=await e,r=n.maxRetries??this.maxRetries;t==null&&(t=r),await this.prepareOptions(n);const{req:a,url:i,timeout:o}=this.buildRequest(n,{retryCount:r-t});if(await this.prepareRequest(a,{url:i,options:n}),Ee("request",i,n,a.headers),(h=n.signal)!=null&&h.aborted)throw new le;const c=new AbortController,l=await this.fetchWithTimeout(i,a,o,c).catch(Nn);if(l instanceof Error){if((d=n.signal)!=null&&d.aborted)throw new le;if(t)return this.retryRequest(n,t);throw l.name==="AbortError"?new Gn:new nn({cause:l})}const u=ea(l.headers);if(!l.ok){if(t&&this.shouldRetry(l)){const g=`retrying, ${t} attempts remaining`;return Ee(`response (error; ${g})`,l.status,i,u),this.retryRequest(n,t,u)}const y=await l.text().catch(g=>Nn(g).message),_=Li(y),w=_?void 0:y;throw Ee(`response (error; ${t?"(error; no more retries left)":"(error; not retryable)"})`,l.status,i,u,w),this.makeStatusError(l.status,_,w,u)}return{response:l,options:n,controller:c}}requestAPIList(e,t){const n=this.makeRequest(t,null);return new $i(this,n,e)}buildURL(e,t){const n=Di(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),r=this.defaultQuery();return ta(r)||(t={...r,...t}),typeof t=="object"&&t&&!Array.isArray(t)&&(n.search=this.stringifyQuery(t)),n.toString()}stringifyQuery(e){return Object.entries(e).filter(([t,n])=>typeof n<"u").map(([t,n])=>{if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")return`${encodeURIComponent(t)}=${encodeURIComponent(n)}`;if(n===null)return`${encodeURIComponent(t)}=`;throw new P(`Cannot stringify type ${typeof n}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,t,n,r){const{signal:a,...i}=t||{};a&&a.addEventListener("abort",()=>r.abort());const o=setTimeout(()=>r.abort(),n),c={signal:r.signal,...i};return c.method&&(c.method=c.method.toUpperCase()),this.fetch.call(void 0,e,c).finally(()=>{clearTimeout(o)})}shouldRetry(e){const t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,t,n){let r;const a=n==null?void 0:n["retry-after-ms"];if(a){const o=parseFloat(a);Number.isNaN(o)||(r=o)}const i=n==null?void 0:n["retry-after"];if(i&&!r){const o=parseFloat(i);Number.isNaN(o)?r=Date.parse(i)-Date.now():r=o*1e3}if(!(r&&0<=r&&r<60*1e3)){const o=e.maxRetries??this.maxRetries;r=this.calculateDefaultRetryTimeoutMillis(t,o)}return await vt(r),this.makeRequest(e,t-1)}calculateDefaultRetryTimeoutMillis(e,t){const a=t-e,i=Math.min(.5*Math.pow(2,a),8),o=1-Math.random()*.25;return i*o*1e3}getUserAgent(){return`${this.constructor.name}/JS ${He}`}}class Qr{constructor(e,t,n,r){Ot.set(this,void 0),Ei(this,Ot,e),this.options=r,this.response=t,this.body=n}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const e=this.nextPageInfo();if(!e)throw new P("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const t={...this.options};if("params"in e&&typeof t.query=="object")t.query={...t.query,...e.params};else if("url"in e){const n=[...Object.entries(t.query||{}),...e.url.searchParams.entries()];for(const[r,a]of n)e.url.searchParams.set(r,a);t.query=void 0,t.path=e.url.toString()}return await Oi(this,Ot,"f").requestAPIList(this.constructor,t)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(Ot=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const t of e.getPaginatedItems())yield t}}class $i extends an{constructor(e,t,n){super(t,async r=>new n(e,r.response,await Gr(r),r.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const t of e)yield t}}const ea=s=>new Proxy(Object.fromEntries(s.entries()),{get(e,t){const n=t.toString();return e[n.toLowerCase()]||e[n]}}),Ii={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__metadata:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},J=s=>typeof s=="object"&&s!==null&&!ta(s)&&Object.keys(s).every(e=>na(Ii,e)),Ni=()=>{var e;if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":He,"X-Stainless-OS":Bs(Deno.build.os),"X-Stainless-Arch":Zs(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((e=Deno.version)==null?void 0:e.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":He,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":He,"X-Stainless-OS":Bs(process.platform),"X-Stainless-Arch":Zs(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const s=ji();return s?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":He,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${s.browser}`,"X-Stainless-Runtime-Version":s.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":He,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function ji(){if(typeof navigator>"u"||!navigator)return null;const s=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:t}of s){const n=t.exec(navigator.userAgent);if(n){const r=n[1]||0,a=n[2]||0,i=n[3]||0;return{browser:e,version:`${r}.${a}.${i}`}}}return null}const Zs=s=>s==="x32"?"x32":s==="x86_64"||s==="x64"?"x64":s==="arm"?"arm":s==="aarch64"||s==="arm64"?"arm64":s?`other:${s}`:"unknown",Bs=s=>(s=s.toLowerCase(),s.includes("ios")?"iOS":s==="android"?"Android":s==="darwin"?"MacOS":s==="win32"?"Windows":s==="freebsd"?"FreeBSD":s==="openbsd"?"OpenBSD":s==="linux"?"Linux":s?`Other:${s}`:"Unknown");let Us;const Mi=()=>Us??(Us=Ni()),Li=s=>{try{return JSON.parse(s)}catch{return}},Fi=/^[a-z][a-z0-9+.-]*:/i,Di=s=>Fi.test(s),vt=s=>new Promise(e=>setTimeout(e,s)),wn=(s,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new P(`${s} must be an integer`);if(e<0)throw new P(`${s} must be a positive integer`);return e},Nn=s=>{if(s instanceof Error)return s;if(typeof s=="object"&&s!==null)try{return new Error(JSON.stringify(s))}catch{}return new Error(s)},Tt=s=>{var e,t,n,r;if(typeof process<"u")return((e=Ye==null?void 0:Ye[s])==null?void 0:e.trim())??void 0;if(typeof Deno<"u")return(r=(n=(t=Deno.env)==null?void 0:t.get)==null?void 0:n.call(t,s))==null?void 0:r.trim()};function ta(s){if(!s)return!0;for(const e in s)return!1;return!0}function na(s,e){return Object.prototype.hasOwnProperty.call(s,e)}function Vs(s,e){for(const t in e){if(!na(e,t))continue;const n=t.toLowerCase();if(!n)continue;const r=e[t];r===null?delete s[n]:r!==void 0&&(s[n]=r)}}const Ws=new Set(["authorization","api-key"]);function Ee(s,...e){if(typeof process<"u"&&(Ye==null?void 0:Ye.DEBUG)==="true"){const t=e.map(n=>{if(!n)return n;if(n.headers){const a={...n,headers:{...n.headers}};for(const i in n.headers)Ws.has(i.toLowerCase())&&(a.headers[i]="REDACTED");return a}let r=null;for(const a in n)Ws.has(a.toLowerCase())&&(r??(r={...n}),r[a]="REDACTED");return r??n});console.log(`OpenAI:DEBUG:${s}`,...t)}}const Zi=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,s=>{const e=Math.random()*16|0;return(s==="x"?e:e&3|8).toString(16)}),Bi=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u",Ui=s=>typeof(s==null?void 0:s.get)=="function",$t=(s,e)=>{var n;const t=e.toLowerCase();if(Ui(s)){const r=((n=e[0])==null?void 0:n.toUpperCase())+e.substring(1).replace(/([^\w])(\w)/g,(a,i,o)=>i+o.toUpperCase());for(const a of[e,t,e.toUpperCase(),r]){const i=s.get(a);if(i)return i}}for(const[r,a]of Object.entries(s))if(r.toLowerCase()===t)return Array.isArray(a)?(a.length<=1||console.warn(`Received ${a.length} entries for the ${e} header, using the first entry.`),a[0]):a},Vi=s=>{if(typeof Buffer<"u"){const e=Buffer.from(s,"base64");return Array.from(new Float32Array(e.buffer,e.byteOffset,e.length/Float32Array.BYTES_PER_ELEMENT))}else{const e=atob(s),t=e.length,n=new Uint8Array(t);for(let r=0;r<t;r++)n[r]=e.charCodeAt(r);return Array.from(new Float32Array(n.buffer))}};function xn(s){return s!=null&&typeof s=="object"&&!Array.isArray(s)}class on extends Qr{constructor(e,t,n,r){super(e,t,n,r),this.data=n.data||[],this.object=n.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}}class Y extends Qr{constructor(e,t,n,r){super(e,t,n,r),this.data=n.data||[],this.has_more=n.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const t=Object.fromEntries(e.url.searchParams);return Object.keys(t).length?t:null}nextPageInfo(){var n;const e=this.getPaginatedItems();if(!e.length)return null;const t=(n=e[e.length-1])==null?void 0:n.id;return t?{params:{after:t}}:null}}class R{constructor(e){this._client=e}}let sa=class extends R{list(e,t={},n){return J(t)?this.list(e,{},t):this._client.getAPIList(`/chat/completions/${e}/messages`,Wi,{query:t,...n})}},cn=class extends R{constructor(){super(...arguments),this.messages=new sa(this._client)}create(e,t){return this._client.post("/chat/completions",{body:e,...t,stream:e.stream??!1})}retrieve(e,t){return this._client.get(`/chat/completions/${e}`,t)}update(e,t,n){return this._client.post(`/chat/completions/${e}`,{body:t,...n})}list(e={},t){return J(e)?this.list({},e):this._client.getAPIList("/chat/completions",ln,{query:e,...t})}del(e,t){return this._client.delete(`/chat/completions/${e}`,t)}};class ln extends Y{}class Wi extends Y{}cn.ChatCompletionsPage=ln;cn.Messages=sa;let un=class extends R{constructor(){super(...arguments),this.completions=new cn(this._client)}};un.Completions=cn;un.ChatCompletionsPage=ln;class ra extends R{create(e,t){return this._client.post("/audio/speech",{body:e,...t,headers:{Accept:"application/octet-stream",...t==null?void 0:t.headers},__binaryResponse:!0})}}class aa extends R{create(e,t){return this._client.post("/audio/transcriptions",De({body:e,...t,stream:e.stream??!1,__metadata:{model:e.model}}))}}class ia extends R{create(e,t){return this._client.post("/audio/translations",De({body:e,...t,__metadata:{model:e.model}}))}}class kt extends R{constructor(){super(...arguments),this.transcriptions=new aa(this._client),this.translations=new ia(this._client),this.speech=new ra(this._client)}}kt.Transcriptions=aa;kt.Translations=ia;kt.Speech=ra;class Yn extends R{create(e,t){return this._client.post("/batches",{body:e,...t})}retrieve(e,t){return this._client.get(`/batches/${e}`,t)}list(e={},t){return J(e)?this.list({},e):this._client.getAPIList("/batches",Qn,{query:e,...t})}cancel(e,t){return this._client.post(`/batches/${e}/cancel`,t)}}class Qn extends Y{}Yn.BatchesPage=Qn;var fe=function(s,e,t,n,r){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?s!==e||!r:!e.has(s))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?r.call(s,t):r?r.value=t:e.set(s,t),t},z=function(s,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?s!==e||!n:!e.has(s))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(s):n?n.value:e.get(s)},jn,Zt,Bt,ct,lt,Ut,ut,ve,dt,Jt,Ht,qe,oa;class es{constructor(){jn.add(this),this.controller=new AbortController,Zt.set(this,void 0),Bt.set(this,()=>{}),ct.set(this,()=>{}),lt.set(this,void 0),Ut.set(this,()=>{}),ut.set(this,()=>{}),ve.set(this,{}),dt.set(this,!1),Jt.set(this,!1),Ht.set(this,!1),qe.set(this,!1),fe(this,Zt,new Promise((e,t)=>{fe(this,Bt,e,"f"),fe(this,ct,t,"f")}),"f"),fe(this,lt,new Promise((e,t)=>{fe(this,Ut,e,"f"),fe(this,ut,t,"f")}),"f"),z(this,Zt,"f").catch(()=>{}),z(this,lt,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},z(this,jn,"m",oa).bind(this))},0)}_connected(){this.ended||(z(this,Bt,"f").call(this),this._emit("connect"))}get ended(){return z(this,dt,"f")}get errored(){return z(this,Jt,"f")}get aborted(){return z(this,Ht,"f")}abort(){this.controller.abort()}on(e,t){return(z(this,ve,"f")[e]||(z(this,ve,"f")[e]=[])).push({listener:t}),this}off(e,t){const n=z(this,ve,"f")[e];if(!n)return this;const r=n.findIndex(a=>a.listener===t);return r>=0&&n.splice(r,1),this}once(e,t){return(z(this,ve,"f")[e]||(z(this,ve,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise((t,n)=>{fe(this,qe,!0,"f"),e!=="error"&&this.once("error",n),this.once(e,t)})}async done(){fe(this,qe,!0,"f"),await z(this,lt,"f")}_emit(e,...t){if(z(this,dt,"f"))return;e==="end"&&(fe(this,dt,!0,"f"),z(this,Ut,"f").call(this));const n=z(this,ve,"f")[e];if(n&&(z(this,ve,"f")[e]=n.filter(r=>!r.once),n.forEach(({listener:r})=>r(...t))),e==="abort"){const r=t[0];!z(this,qe,"f")&&!(n!=null&&n.length)&&Promise.reject(r),z(this,ct,"f").call(this,r),z(this,ut,"f").call(this,r),this._emit("end");return}if(e==="error"){const r=t[0];!z(this,qe,"f")&&!(n!=null&&n.length)&&Promise.reject(r),z(this,ct,"f").call(this,r),z(this,ut,"f").call(this,r),this._emit("end")}}_emitFinal(){}}Zt=new WeakMap,Bt=new WeakMap,ct=new WeakMap,lt=new WeakMap,Ut=new WeakMap,ut=new WeakMap,ve=new WeakMap,dt=new WeakMap,Jt=new WeakMap,Ht=new WeakMap,qe=new WeakMap,jn=new WeakSet,oa=function(e){if(fe(this,Jt,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new le),e instanceof le)return fe(this,Ht,!0,"f"),this._emit("abort",e);if(e instanceof P)return this._emit("error",e);if(e instanceof Error){const t=new P(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new P(String(e)))};var S=function(s,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?s!==e||!n:!e.has(s))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(s):n?n.value:e.get(s)},ae=function(s,e,t,n,r){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?s!==e||!r:!e.has(s))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?r.call(s,t):r?r.value=t:e.set(s,t),t},ee,Mn,_e,Vt,me,Fe,Ge,Le,qt,oe,Wt,zt,gt,ht,ft,zs,Js,Hs,qs,Xs,Ks,Gs;class pe extends es{constructor(){super(...arguments),ee.add(this),Mn.set(this,[]),_e.set(this,{}),Vt.set(this,{}),me.set(this,void 0),Fe.set(this,void 0),Ge.set(this,void 0),Le.set(this,void 0),qt.set(this,void 0),oe.set(this,void 0),Wt.set(this,void 0),zt.set(this,void 0),gt.set(this,void 0)}[(Mn=new WeakMap,_e=new WeakMap,Vt=new WeakMap,me=new WeakMap,Fe=new WeakMap,Ge=new WeakMap,Le=new WeakMap,qt=new WeakMap,oe=new WeakMap,Wt=new WeakMap,zt=new WeakMap,gt=new WeakMap,ee=new WeakSet,Symbol.asyncIterator)](){const e=[],t=[];let n=!1;return this.on("event",r=>{const a=t.shift();a?a.resolve(r):e.push(r)}),this.on("end",()=>{n=!0;for(const r of t)r.resolve(void 0);t.length=0}),this.on("abort",r=>{n=!0;for(const a of t)a.reject(r);t.length=0}),this.on("error",r=>{n=!0;for(const a of t)a.reject(r);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((a,i)=>t.push({resolve:a,reject:i})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const t=new pe;return t._run(()=>t._fromReadableStream(e)),t}async _fromReadableStream(e,t){var a;const n=t==null?void 0:t.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),this._connected();const r=be.fromReadableStream(e,this.controller);for await(const i of r)S(this,ee,"m",ht).call(this,i);if((a=r.controller.signal)!=null&&a.aborted)throw new le;return this._addRun(S(this,ee,"m",ft).call(this))}toReadableStream(){return new be(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,t,n,r,a){const i=new pe;return i._run(()=>i._runToolAssistantStream(e,t,n,r,{...a,headers:{...a==null?void 0:a.headers,"X-Stainless-Helper-Method":"stream"}})),i}async _createToolAssistantStream(e,t,n,r,a){var l;const i=a==null?void 0:a.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const o={...r,stream:!0},c=await e.submitToolOutputs(t,n,o,{...a,signal:this.controller.signal});this._connected();for await(const u of c)S(this,ee,"m",ht).call(this,u);if((l=c.controller.signal)!=null&&l.aborted)throw new le;return this._addRun(S(this,ee,"m",ft).call(this))}static createThreadAssistantStream(e,t,n){const r=new pe;return r._run(()=>r._threadAssistantStream(e,t,{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"stream"}})),r}static createAssistantStream(e,t,n,r){const a=new pe;return a._run(()=>a._runAssistantStream(e,t,n,{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),a}currentEvent(){return S(this,Wt,"f")}currentRun(){return S(this,zt,"f")}currentMessageSnapshot(){return S(this,me,"f")}currentRunStepSnapshot(){return S(this,gt,"f")}async finalRunSteps(){return await this.done(),Object.values(S(this,_e,"f"))}async finalMessages(){return await this.done(),Object.values(S(this,Vt,"f"))}async finalRun(){if(await this.done(),!S(this,Fe,"f"))throw Error("Final run was not received.");return S(this,Fe,"f")}async _createThreadAssistantStream(e,t,n){var o;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort()));const a={...t,stream:!0},i=await e.createAndRun(a,{...n,signal:this.controller.signal});this._connected();for await(const c of i)S(this,ee,"m",ht).call(this,c);if((o=i.controller.signal)!=null&&o.aborted)throw new le;return this._addRun(S(this,ee,"m",ft).call(this))}async _createAssistantStream(e,t,n,r){var c;const a=r==null?void 0:r.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const i={...n,stream:!0},o=await e.create(t,i,{...r,signal:this.controller.signal});this._connected();for await(const l of o)S(this,ee,"m",ht).call(this,l);if((c=o.controller.signal)!=null&&c.aborted)throw new le;return this._addRun(S(this,ee,"m",ft).call(this))}static accumulateDelta(e,t){for(const[n,r]of Object.entries(t)){if(!e.hasOwnProperty(n)){e[n]=r;continue}let a=e[n];if(a==null){e[n]=r;continue}if(n==="index"||n==="type"){e[n]=r;continue}if(typeof a=="string"&&typeof r=="string")a+=r;else if(typeof a=="number"&&typeof r=="number")a+=r;else if(xn(a)&&xn(r))a=this.accumulateDelta(a,r);else if(Array.isArray(a)&&Array.isArray(r)){if(a.every(i=>typeof i=="string"||typeof i=="number")){a.push(...r);continue}for(const i of r){if(!xn(i))throw new Error(`Expected array delta entry to be an object but got: ${i}`);const o=i.index;if(o==null)throw console.error(i),new Error("Expected array delta entry to have an `index` property");if(typeof o!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${o}`);const c=a[o];c==null?a.push(i):a[o]=this.accumulateDelta(c,i)}continue}else throw Error(`Unhandled record type: ${n}, deltaValue: ${r}, accValue: ${a}`);e[n]=a}return e}_addRun(e){return e}async _threadAssistantStream(e,t,n){return await this._createThreadAssistantStream(t,e,n)}async _runAssistantStream(e,t,n,r){return await this._createAssistantStream(t,e,n,r)}async _runToolAssistantStream(e,t,n,r,a){return await this._createToolAssistantStream(n,e,t,r,a)}}ht=function(e){if(!this.ended)switch(ae(this,Wt,e,"f"),S(this,ee,"m",Hs).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":S(this,ee,"m",Gs).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":S(this,ee,"m",Js).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":S(this,ee,"m",zs).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},ft=function(){if(this.ended)throw new P("stream has ended, this shouldn't happen");if(!S(this,Fe,"f"))throw Error("Final run has not been received");return S(this,Fe,"f")},zs=function(e){const[t,n]=S(this,ee,"m",Xs).call(this,e,S(this,me,"f"));ae(this,me,t,"f"),S(this,Vt,"f")[t.id]=t;for(const r of n){const a=t.content[r.index];(a==null?void 0:a.type)=="text"&&this._emit("textCreated",a.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,t),e.data.delta.content)for(const r of e.data.delta.content){if(r.type=="text"&&r.text){let a=r.text,i=t.content[r.index];if(i&&i.type=="text")this._emit("textDelta",a,i.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(r.index!=S(this,Ge,"f")){if(S(this,Le,"f"))switch(S(this,Le,"f").type){case"text":this._emit("textDone",S(this,Le,"f").text,S(this,me,"f"));break;case"image_file":this._emit("imageFileDone",S(this,Le,"f").image_file,S(this,me,"f"));break}ae(this,Ge,r.index,"f")}ae(this,Le,t.content[r.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(S(this,Ge,"f")!==void 0){const r=e.data.content[S(this,Ge,"f")];if(r)switch(r.type){case"image_file":this._emit("imageFileDone",r.image_file,S(this,me,"f"));break;case"text":this._emit("textDone",r.text,S(this,me,"f"));break}}S(this,me,"f")&&this._emit("messageDone",e.data),ae(this,me,void 0,"f")}},Js=function(e){const t=S(this,ee,"m",qs).call(this,e);switch(ae(this,gt,t,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const n=e.data.delta;if(n.step_details&&n.step_details.type=="tool_calls"&&n.step_details.tool_calls&&t.step_details.type=="tool_calls")for(const a of n.step_details.tool_calls)a.index==S(this,qt,"f")?this._emit("toolCallDelta",a,t.step_details.tool_calls[a.index]):(S(this,oe,"f")&&this._emit("toolCallDone",S(this,oe,"f")),ae(this,qt,a.index,"f"),ae(this,oe,t.step_details.tool_calls[a.index],"f"),S(this,oe,"f")&&this._emit("toolCallCreated",S(this,oe,"f")));this._emit("runStepDelta",e.data.delta,t);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":ae(this,gt,void 0,"f"),e.data.step_details.type=="tool_calls"&&S(this,oe,"f")&&(this._emit("toolCallDone",S(this,oe,"f")),ae(this,oe,void 0,"f")),this._emit("runStepDone",e.data,t);break}},Hs=function(e){S(this,Mn,"f").push(e),this._emit("event",e)},qs=function(e){switch(e.event){case"thread.run.step.created":return S(this,_e,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let t=S(this,_e,"f")[e.data.id];if(!t)throw Error("Received a RunStepDelta before creation of a snapshot");let n=e.data;if(n.delta){const r=pe.accumulateDelta(t,n.delta);S(this,_e,"f")[e.data.id]=r}return S(this,_e,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":S(this,_e,"f")[e.data.id]=e.data;break}if(S(this,_e,"f")[e.data.id])return S(this,_e,"f")[e.data.id];throw new Error("No snapshot available")},Xs=function(e,t){let n=[];switch(e.event){case"thread.message.created":return[e.data,n];case"thread.message.delta":if(!t)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let r=e.data;if(r.delta.content)for(const a of r.delta.content)if(a.index in t.content){let i=t.content[a.index];t.content[a.index]=S(this,ee,"m",Ks).call(this,a,i)}else t.content[a.index]=a,n.push(a);return[t,n];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(t)return[t,n];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},Ks=function(e,t){return pe.accumulateDelta(t,e)},Gs=function(e){switch(ae(this,zt,e.data,"f"),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":ae(this,Fe,e.data,"f"),S(this,oe,"f")&&(this._emit("toolCallDone",S(this,oe,"f")),ae(this,oe,void 0,"f"));break}};class ts extends R{create(e,t){return this._client.post("/assistants",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}retrieve(e,t){return this._client.get(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}update(e,t,n){return this._client.post(`/assistants/${e}`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}list(e={},t){return J(e)?this.list({},e):this._client.getAPIList("/assistants",ns,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}del(e,t){return this._client.delete(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}}class ns extends Y{}ts.AssistantsPage=ns;function Ys(s){return typeof s.parse=="function"}const Qe=s=>(s==null?void 0:s.role)==="assistant",ca=s=>(s==null?void 0:s.role)==="function",la=s=>(s==null?void 0:s.role)==="tool";function zi(s,e){const t={...s};return Object.defineProperties(t,{$brand:{value:"auto-parseable-response-format",enumerable:!1},$parseRaw:{value:e,enumerable:!1}}),t}function ss(s){return(s==null?void 0:s.$brand)==="auto-parseable-response-format"}function St(s){return(s==null?void 0:s.$brand)==="auto-parseable-tool"}function Ji(s,e){return!e||!ua(e)?{...s,choices:s.choices.map(t=>({...t,message:{...t.message,parsed:null,...t.message.tool_calls?{tool_calls:t.message.tool_calls}:void 0}}))}:rs(s,e)}function rs(s,e){const t=s.choices.map(n=>{var r;if(n.finish_reason==="length")throw new zr;if(n.finish_reason==="content_filter")throw new Jr;return{...n,message:{...n.message,...n.message.tool_calls?{tool_calls:((r=n.message.tool_calls)==null?void 0:r.map(a=>qi(e,a)))??void 0}:void 0,parsed:n.message.content&&!n.message.refusal?Hi(e,n.message.content):null}}});return{...s,choices:t}}function Hi(s,e){var t,n;return((t=s.response_format)==null?void 0:t.type)!=="json_schema"?null:((n=s.response_format)==null?void 0:n.type)==="json_schema"?"$parseRaw"in s.response_format?s.response_format.$parseRaw(e):JSON.parse(e):null}function qi(s,e){var n;const t=(n=s.tools)==null?void 0:n.find(r=>{var a;return((a=r.function)==null?void 0:a.name)===e.function.name});return{...e,function:{...e.function,parsed_arguments:St(t)?t.$parseRaw(e.function.arguments):t!=null&&t.function.strict?JSON.parse(e.function.arguments):null}}}function Xi(s,e){var n;if(!s)return!1;const t=(n=s.tools)==null?void 0:n.find(r=>{var a;return((a=r.function)==null?void 0:a.name)===e.function.name});return St(t)||(t==null?void 0:t.function.strict)||!1}function ua(s){var e;return ss(s.response_format)?!0:((e=s.tools)==null?void 0:e.some(t=>St(t)||t.type==="function"&&t.function.strict===!0))??!1}function Ki(s){for(const e of s??[]){if(e.type!=="function")throw new P(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(e.function.strict!==!0)throw new P(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}var re=function(s,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?s!==e||!n:!e.has(s))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(s):n?n.value:e.get(s)},ne,Ln,Xt,Fn,Dn,Zn,da,Bn;const Qs=10;class ha extends es{constructor(){super(...arguments),ne.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){var n;this._chatCompletions.push(e),this._emit("chatCompletion",e);const t=(n=e.choices[0])==null?void 0:n.message;return t&&this._addMessage(t),e}_addMessage(e,t=!0){if("content"in e||(e.content=null),this.messages.push(e),t){if(this._emit("message",e),(ca(e)||la(e))&&e.content)this._emit("functionCallResult",e.content);else if(Qe(e)&&e.function_call)this._emit("functionCall",e.function_call);else if(Qe(e)&&e.tool_calls)for(const n of e.tool_calls)n.type==="function"&&this._emit("functionCall",n.function)}}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new P("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),re(this,ne,"m",Ln).call(this)}async finalMessage(){return await this.done(),re(this,ne,"m",Xt).call(this)}async finalFunctionCall(){return await this.done(),re(this,ne,"m",Fn).call(this)}async finalFunctionCallResult(){return await this.done(),re(this,ne,"m",Dn).call(this)}async totalUsage(){return await this.done(),re(this,ne,"m",Zn).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const t=re(this,ne,"m",Xt).call(this);t&&this._emit("finalMessage",t);const n=re(this,ne,"m",Ln).call(this);n&&this._emit("finalContent",n);const r=re(this,ne,"m",Fn).call(this);r&&this._emit("finalFunctionCall",r);const a=re(this,ne,"m",Dn).call(this);a!=null&&this._emit("finalFunctionCallResult",a),this._chatCompletions.some(i=>i.usage)&&this._emit("totalUsage",re(this,ne,"m",Zn).call(this))}async _createChatCompletion(e,t,n){const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),re(this,ne,"m",da).call(this,t);const a=await e.chat.completions.create({...t,stream:!1},{...n,signal:this.controller.signal});return this._connected(),this._addChatCompletion(rs(a,t))}async _runChatCompletion(e,t,n){for(const r of t.messages)this._addMessage(r,!1);return await this._createChatCompletion(e,t,n)}async _runFunctions(e,t,n){var d;const r="function",{function_call:a="auto",stream:i,...o}=t,c=typeof a!="string"&&(a==null?void 0:a.name),{maxChatCompletions:l=Qs}=n||{},u={};for(const y of t.functions)u[y.name||y.function.name]=y;const h=t.functions.map(y=>({name:y.name||y.function.name,parameters:y.parameters,description:y.description}));for(const y of t.messages)this._addMessage(y,!1);for(let y=0;y<l;++y){const w=(d=(await this._createChatCompletion(e,{...o,function_call:a,functions:h,messages:[...this.messages]},n)).choices[0])==null?void 0:d.message;if(!w)throw new P("missing message in ChatCompletion response");if(!w.function_call)return;const{name:x,arguments:V}=w.function_call,g=u[x];if(g){if(c&&c!==x){const N=`Invalid function_call: ${JSON.stringify(x)}. ${JSON.stringify(c)} requested. Please try again`;this._addMessage({role:r,name:x,content:N});continue}}else{const N=`Invalid function_call: ${JSON.stringify(x)}. Available options are: ${h.map(T=>JSON.stringify(T.name)).join(", ")}. Please try again`;this._addMessage({role:r,name:x,content:N});continue}let A;try{A=Ys(g)?await g.parse(V):V}catch(N){this._addMessage({role:r,name:x,content:N instanceof Error?N.message:String(N)});continue}const C=await g.function(A,this),F=re(this,ne,"m",Bn).call(this,C);if(this._addMessage({role:r,name:x,content:F}),c)return}}async _runTools(e,t,n){var y,_,w;const r="tool",{tool_choice:a="auto",stream:i,...o}=t,c=typeof a!="string"&&((y=a==null?void 0:a.function)==null?void 0:y.name),{maxChatCompletions:l=Qs}=n||{},u=t.tools.map(x=>{if(St(x)){if(!x.$callback)throw new P("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:x.$callback,name:x.function.name,description:x.function.description||"",parameters:x.function.parameters,parse:x.$parseRaw,strict:!0}}}return x}),h={};for(const x of u)x.type==="function"&&(h[x.function.name||x.function.function.name]=x.function);const d="tools"in t?u.map(x=>x.type==="function"?{type:"function",function:{name:x.function.name||x.function.function.name,parameters:x.function.parameters,description:x.function.description,strict:x.function.strict}}:x):void 0;for(const x of t.messages)this._addMessage(x,!1);for(let x=0;x<l;++x){const g=(_=(await this._createChatCompletion(e,{...o,tool_choice:a,tools:d,messages:[...this.messages]},n)).choices[0])==null?void 0:_.message;if(!g)throw new P("missing message in ChatCompletion response");if(!((w=g.tool_calls)!=null&&w.length))return;for(const A of g.tool_calls){if(A.type!=="function")continue;const C=A.id,{name:F,arguments:N}=A.function,T=h[F];if(T){if(c&&c!==F){const Z=`Invalid tool_call: ${JSON.stringify(F)}. ${JSON.stringify(c)} requested. Please try again`;this._addMessage({role:r,tool_call_id:C,content:Z});continue}}else{const Z=`Invalid tool_call: ${JSON.stringify(F)}. Available options are: ${Object.keys(h).map(I=>JSON.stringify(I)).join(", ")}. Please try again`;this._addMessage({role:r,tool_call_id:C,content:Z});continue}let se;try{se=Ys(T)?await T.parse(N):N}catch(Z){const I=Z instanceof Error?Z.message:String(Z);this._addMessage({role:r,tool_call_id:C,content:I});continue}const H=await T.function(se,this),W=re(this,ne,"m",Bn).call(this,H);if(this._addMessage({role:r,tool_call_id:C,content:W}),c)return}}}}ne=new WeakSet,Ln=function(){return re(this,ne,"m",Xt).call(this).content??null},Xt=function(){let e=this.messages.length;for(;e-- >0;){const t=this.messages[e];if(Qe(t)){const{function_call:n,...r}=t,a={...r,content:t.content??null,refusal:t.refusal??null};return n&&(a.function_call=n),a}}throw new P("stream ended without producing a ChatCompletionMessage with role=assistant")},Fn=function(){var e,t;for(let n=this.messages.length-1;n>=0;n--){const r=this.messages[n];if(Qe(r)&&(r!=null&&r.function_call))return r.function_call;if(Qe(r)&&((e=r==null?void 0:r.tool_calls)!=null&&e.length))return(t=r.tool_calls.at(-1))==null?void 0:t.function}},Dn=function(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages[e];if(ca(t)&&t.content!=null||la(t)&&t.content!=null&&typeof t.content=="string"&&this.messages.some(n=>{var r;return n.role==="assistant"&&((r=n.tool_calls)==null?void 0:r.some(a=>a.type==="function"&&a.id===t.tool_call_id))}))return t.content}},Zn=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:t}of this._chatCompletions)t&&(e.completion_tokens+=t.completion_tokens,e.prompt_tokens+=t.prompt_tokens,e.total_tokens+=t.total_tokens);return e},da=function(e){if(e.n!=null&&e.n>1)throw new P("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},Bn=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class yt extends ha{static runFunctions(e,t,n){const r=new yt,a={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runFunctions"}};return r._run(()=>r._runFunctions(e,t,a)),r}static runTools(e,t,n){const r=new yt,a={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runTools"}};return r._run(()=>r._runTools(e,t,a)),r}_addMessage(e,t=!0){super._addMessage(e,t),Qe(e)&&e.content&&this._emit("content",e.content)}}const fa=1,ma=2,pa=4,ga=8,ya=16,_a=32,ba=64,wa=128,xa=256,va=wa|xa,ka=ya|_a|va|ba,Sa=fa|ma|ka,Aa=pa|ga,Gi=Sa|Aa,Q={STR:fa,NUM:ma,ARR:pa,OBJ:ga,NULL:ya,BOOL:_a,NAN:ba,INFINITY:wa,MINUS_INFINITY:xa,INF:va,SPECIAL:ka,ATOM:Sa,COLLECTION:Aa,ALL:Gi};class Yi extends Error{}class Qi extends Error{}function eo(s,e=Q.ALL){if(typeof s!="string")throw new TypeError(`expecting str, got ${typeof s}`);if(!s.trim())throw new Error(`${s} is empty`);return to(s.trim(),e)}const to=(s,e)=>{const t=s.length;let n=0;const r=d=>{throw new Yi(`${d} at position ${n}`)},a=d=>{throw new Qi(`${d} at position ${n}`)},i=()=>(h(),n>=t&&r("Unexpected end of input"),s[n]==='"'?o():s[n]==="{"?c():s[n]==="["?l():s.substring(n,n+4)==="null"||Q.NULL&e&&t-n<4&&"null".startsWith(s.substring(n))?(n+=4,null):s.substring(n,n+4)==="true"||Q.BOOL&e&&t-n<4&&"true".startsWith(s.substring(n))?(n+=4,!0):s.substring(n,n+5)==="false"||Q.BOOL&e&&t-n<5&&"false".startsWith(s.substring(n))?(n+=5,!1):s.substring(n,n+8)==="Infinity"||Q.INFINITY&e&&t-n<8&&"Infinity".startsWith(s.substring(n))?(n+=8,1/0):s.substring(n,n+9)==="-Infinity"||Q.MINUS_INFINITY&e&&1<t-n&&t-n<9&&"-Infinity".startsWith(s.substring(n))?(n+=9,-1/0):s.substring(n,n+3)==="NaN"||Q.NAN&e&&t-n<3&&"NaN".startsWith(s.substring(n))?(n+=3,NaN):u()),o=()=>{const d=n;let y=!1;for(n++;n<t&&(s[n]!=='"'||y&&s[n-1]==="\\");)y=s[n]==="\\"?!y:!1,n++;if(s.charAt(n)=='"')try{return JSON.parse(s.substring(d,++n-Number(y)))}catch(_){a(String(_))}else if(Q.STR&e)try{return JSON.parse(s.substring(d,n-Number(y))+'"')}catch{return JSON.parse(s.substring(d,s.lastIndexOf("\\"))+'"')}r("Unterminated string literal")},c=()=>{n++,h();const d={};try{for(;s[n]!=="}";){if(h(),n>=t&&Q.OBJ&e)return d;const y=o();h(),n++;try{const _=i();Object.defineProperty(d,y,{value:_,writable:!0,enumerable:!0,configurable:!0})}catch(_){if(Q.OBJ&e)return d;throw _}h(),s[n]===","&&n++}}catch{if(Q.OBJ&e)return d;r("Expected '}' at end of object")}return n++,d},l=()=>{n++;const d=[];try{for(;s[n]!=="]";)d.push(i()),h(),s[n]===","&&n++}catch{if(Q.ARR&e)return d;r("Expected ']' at end of array")}return n++,d},u=()=>{if(n===0){s==="-"&&Q.NUM&e&&r("Not sure what '-' is");try{return JSON.parse(s)}catch(y){if(Q.NUM&e)try{return s[s.length-1]==="."?JSON.parse(s.substring(0,s.lastIndexOf("."))):JSON.parse(s.substring(0,s.lastIndexOf("e")))}catch{}a(String(y))}}const d=n;for(s[n]==="-"&&n++;s[n]&&!",]}".includes(s[n]);)n++;n==t&&!(Q.NUM&e)&&r("Unterminated number literal");try{return JSON.parse(s.substring(d,n))}catch{s.substring(d,n)==="-"&&Q.NUM&e&&r("Not sure what '-' is");try{return JSON.parse(s.substring(d,s.lastIndexOf("e")))}catch(_){a(String(_))}}},h=()=>{for(;n<t&&` 
\r	`.includes(s[n]);)n++};return i()},er=s=>eo(s,Q.ALL^Q.NUM);var Ve=function(s,e,t,n,r){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?s!==e||!r:!e.has(s))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?r.call(s,t):r?r.value=t:e.set(s,t),t},U=function(s,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?s!==e||!n:!e.has(s))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(s):n?n.value:e.get(s)},K,xe,We,Se,vn,It,kn,Sn,An,Nt,Cn,tr;class _t extends ha{constructor(e){super(),K.add(this),xe.set(this,void 0),We.set(this,void 0),Se.set(this,void 0),Ve(this,xe,e,"f"),Ve(this,We,[],"f")}get currentChatCompletionSnapshot(){return U(this,Se,"f")}static fromReadableStream(e){const t=new _t(null);return t._run(()=>t._fromReadableStream(e)),t}static createChatCompletion(e,t,n){const r=new _t(t);return r._run(()=>r._runChatCompletion(e,{...t,stream:!0},{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"stream"}})),r}async _createChatCompletion(e,t,n){var i;super._createChatCompletion;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),U(this,K,"m",vn).call(this);const a=await e.chat.completions.create({...t,stream:!0},{...n,signal:this.controller.signal});this._connected();for await(const o of a)U(this,K,"m",kn).call(this,o);if((i=a.controller.signal)!=null&&i.aborted)throw new le;return this._addChatCompletion(U(this,K,"m",Nt).call(this))}async _fromReadableStream(e,t){var i;const n=t==null?void 0:t.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),U(this,K,"m",vn).call(this),this._connected();const r=be.fromReadableStream(e,this.controller);let a;for await(const o of r)a&&a!==o.id&&this._addChatCompletion(U(this,K,"m",Nt).call(this)),U(this,K,"m",kn).call(this,o),a=o.id;if((i=r.controller.signal)!=null&&i.aborted)throw new le;return this._addChatCompletion(U(this,K,"m",Nt).call(this))}[(xe=new WeakMap,We=new WeakMap,Se=new WeakMap,K=new WeakSet,vn=function(){this.ended||Ve(this,Se,void 0,"f")},It=function(t){let n=U(this,We,"f")[t.index];return n||(n={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},U(this,We,"f")[t.index]=n,n)},kn=function(t){var r,a,i,o,c,l,u,h,d,y,_,w,x,V,g;if(this.ended)return;const n=U(this,K,"m",tr).call(this,t);this._emit("chunk",t,n);for(const A of t.choices){const C=n.choices[A.index];A.delta.content!=null&&((r=C.message)==null?void 0:r.role)==="assistant"&&((a=C.message)!=null&&a.content)&&(this._emit("content",A.delta.content,C.message.content),this._emit("content.delta",{delta:A.delta.content,snapshot:C.message.content,parsed:C.message.parsed})),A.delta.refusal!=null&&((i=C.message)==null?void 0:i.role)==="assistant"&&((o=C.message)!=null&&o.refusal)&&this._emit("refusal.delta",{delta:A.delta.refusal,snapshot:C.message.refusal}),((c=A.logprobs)==null?void 0:c.content)!=null&&((l=C.message)==null?void 0:l.role)==="assistant"&&this._emit("logprobs.content.delta",{content:(u=A.logprobs)==null?void 0:u.content,snapshot:((h=C.logprobs)==null?void 0:h.content)??[]}),((d=A.logprobs)==null?void 0:d.refusal)!=null&&((y=C.message)==null?void 0:y.role)==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:(_=A.logprobs)==null?void 0:_.refusal,snapshot:((w=C.logprobs)==null?void 0:w.refusal)??[]});const F=U(this,K,"m",It).call(this,C);C.finish_reason&&(U(this,K,"m",An).call(this,C),F.current_tool_call_index!=null&&U(this,K,"m",Sn).call(this,C,F.current_tool_call_index));for(const N of A.delta.tool_calls??[])F.current_tool_call_index!==N.index&&(U(this,K,"m",An).call(this,C),F.current_tool_call_index!=null&&U(this,K,"m",Sn).call(this,C,F.current_tool_call_index)),F.current_tool_call_index=N.index;for(const N of A.delta.tool_calls??[]){const T=(x=C.message.tool_calls)==null?void 0:x[N.index];T!=null&&T.type&&((T==null?void 0:T.type)==="function"?this._emit("tool_calls.function.arguments.delta",{name:(V=T.function)==null?void 0:V.name,index:N.index,arguments:T.function.arguments,parsed_arguments:T.function.parsed_arguments,arguments_delta:((g=N.function)==null?void 0:g.arguments)??""}):(T==null||T.type,void 0))}}},Sn=function(t,n){var i,o,c;if(U(this,K,"m",It).call(this,t).done_tool_calls.has(n))return;const a=(i=t.message.tool_calls)==null?void 0:i[n];if(!a)throw new Error("no tool call snapshot");if(!a.type)throw new Error("tool call snapshot missing `type`");if(a.type==="function"){const l=(c=(o=U(this,xe,"f"))==null?void 0:o.tools)==null?void 0:c.find(u=>u.type==="function"&&u.function.name===a.function.name);this._emit("tool_calls.function.arguments.done",{name:a.function.name,index:n,arguments:a.function.arguments,parsed_arguments:St(l)?l.$parseRaw(a.function.arguments):l!=null&&l.function.strict?JSON.parse(a.function.arguments):null})}else a.type},An=function(t){var r,a;const n=U(this,K,"m",It).call(this,t);if(t.message.content&&!n.content_done){n.content_done=!0;const i=U(this,K,"m",Cn).call(this);this._emit("content.done",{content:t.message.content,parsed:i?i.$parseRaw(t.message.content):null})}t.message.refusal&&!n.refusal_done&&(n.refusal_done=!0,this._emit("refusal.done",{refusal:t.message.refusal})),(r=t.logprobs)!=null&&r.content&&!n.logprobs_content_done&&(n.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:t.logprobs.content})),(a=t.logprobs)!=null&&a.refusal&&!n.logprobs_refusal_done&&(n.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:t.logprobs.refusal}))},Nt=function(){if(this.ended)throw new P("stream has ended, this shouldn't happen");const t=U(this,Se,"f");if(!t)throw new P("request ended without sending any chunks");return Ve(this,Se,void 0,"f"),Ve(this,We,[],"f"),no(t,U(this,xe,"f"))},Cn=function(){var n;const t=(n=U(this,xe,"f"))==null?void 0:n.response_format;return ss(t)?t:null},tr=function(t){var n,r,a,i;let o=U(this,Se,"f");const{choices:c,...l}=t;o?Object.assign(o,l):o=Ve(this,Se,{...l,choices:[]},"f");for(const{delta:u,finish_reason:h,index:d,logprobs:y=null,..._}of t.choices){let w=o.choices[d];if(w||(w=o.choices[d]={finish_reason:h,index:d,message:{},logprobs:y,..._}),y)if(!w.logprobs)w.logprobs=Object.assign({},y);else{const{content:N,refusal:T,...se}=y;Object.assign(w.logprobs,se),N&&((n=w.logprobs).content??(n.content=[]),w.logprobs.content.push(...N)),T&&((r=w.logprobs).refusal??(r.refusal=[]),w.logprobs.refusal.push(...T))}if(h&&(w.finish_reason=h,U(this,xe,"f")&&ua(U(this,xe,"f")))){if(h==="length")throw new zr;if(h==="content_filter")throw new Jr}if(Object.assign(w,_),!u)continue;const{content:x,refusal:V,function_call:g,role:A,tool_calls:C,...F}=u;if(Object.assign(w.message,F),V&&(w.message.refusal=(w.message.refusal||"")+V),A&&(w.message.role=A),g&&(w.message.function_call?(g.name&&(w.message.function_call.name=g.name),g.arguments&&((a=w.message.function_call).arguments??(a.arguments=""),w.message.function_call.arguments+=g.arguments)):w.message.function_call=g),x&&(w.message.content=(w.message.content||"")+x,!w.message.refusal&&U(this,K,"m",Cn).call(this)&&(w.message.parsed=er(w.message.content))),C){w.message.tool_calls||(w.message.tool_calls=[]);for(const{index:N,id:T,type:se,function:H,...W}of C){const Z=(i=w.message.tool_calls)[N]??(i[N]={});Object.assign(Z,W),T&&(Z.id=T),se&&(Z.type=se),H&&(Z.function??(Z.function={name:H.name??"",arguments:""})),H!=null&&H.name&&(Z.function.name=H.name),H!=null&&H.arguments&&(Z.function.arguments+=H.arguments,Xi(U(this,xe,"f"),Z)&&(Z.function.parsed_arguments=er(Z.function.arguments)))}}}return o},Symbol.asyncIterator)](){const e=[],t=[];let n=!1;return this.on("chunk",r=>{const a=t.shift();a?a.resolve(r):e.push(r)}),this.on("end",()=>{n=!0;for(const r of t)r.resolve(void 0);t.length=0}),this.on("abort",r=>{n=!0;for(const a of t)a.reject(r);t.length=0}),this.on("error",r=>{n=!0;for(const a of t)a.reject(r);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((a,i)=>t.push({resolve:a,reject:i})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new be(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function no(s,e){const{id:t,choices:n,created:r,model:a,system_fingerprint:i,...o}=s,c={...o,id:t,choices:n.map(({message:l,finish_reason:u,index:h,logprobs:d,...y})=>{if(!u)throw new P(`missing finish_reason for choice ${h}`);const{content:_=null,function_call:w,tool_calls:x,...V}=l,g=l.role;if(!g)throw new P(`missing role for choice ${h}`);if(w){const{arguments:A,name:C}=w;if(A==null)throw new P(`missing function_call.arguments for choice ${h}`);if(!C)throw new P(`missing function_call.name for choice ${h}`);return{...y,message:{content:_,function_call:{arguments:A,name:C},role:g,refusal:l.refusal??null},finish_reason:u,index:h,logprobs:d}}return x?{...y,index:h,finish_reason:u,logprobs:d,message:{...V,role:g,content:_,refusal:l.refusal??null,tool_calls:x.map((A,C)=>{const{function:F,type:N,id:T,...se}=A,{arguments:H,name:W,...Z}=F||{};if(T==null)throw new P(`missing choices[${h}].tool_calls[${C}].id
${jt(s)}`);if(N==null)throw new P(`missing choices[${h}].tool_calls[${C}].type
${jt(s)}`);if(W==null)throw new P(`missing choices[${h}].tool_calls[${C}].function.name
${jt(s)}`);if(H==null)throw new P(`missing choices[${h}].tool_calls[${C}].function.arguments
${jt(s)}`);return{...se,id:T,type:N,function:{...Z,name:W,arguments:H}}})}}:{...y,message:{...V,content:_,role:g,refusal:l.refusal??null},finish_reason:u,index:h,logprobs:d}}),created:r,model:a,object:"chat.completion",...i?{system_fingerprint:i}:{}};return Ji(c,e)}function jt(s){return JSON.stringify(s)}class et extends _t{static fromReadableStream(e){const t=new et(null);return t._run(()=>t._fromReadableStream(e)),t}static runFunctions(e,t,n){const r=new et(null),a={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runFunctions"}};return r._run(()=>r._runFunctions(e,t,a)),r}static runTools(e,t,n){const r=new et(t),a={...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"runTools"}};return r._run(()=>r._runTools(e,t,a)),r}}let Ca=class extends R{parse(e,t){return Ki(e.tools),this._client.chat.completions.create(e,{...t,headers:{...t==null?void 0:t.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}})._thenUnwrap(n=>rs(n,e))}runFunctions(e,t){return e.stream?et.runFunctions(this._client,e,t):yt.runFunctions(this._client,e,t)}runTools(e,t){return e.stream?et.runTools(this._client,e,t):yt.runTools(this._client,e,t)}stream(e,t){return _t.createChatCompletion(this._client,e,t)}};class Un extends R{constructor(){super(...arguments),this.completions=new Ca(this._client)}}(function(s){s.Completions=Ca})(Un||(Un={}));class Pa extends R{create(e,t){return this._client.post("/realtime/sessions",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}}class Ra extends R{create(e,t){return this._client.post("/realtime/transcription_sessions",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}}class dn extends R{constructor(){super(...arguments),this.sessions=new Pa(this._client),this.transcriptionSessions=new Ra(this._client)}}dn.Sessions=Pa;dn.TranscriptionSessions=Ra;class as extends R{create(e,t,n){return this._client.post(`/threads/${e}/messages`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,t,n){return this._client.get(`/threads/${e}/messages/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,t,n,r){return this._client.post(`/threads/${e}/messages/${t}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(e,t={},n){return J(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/messages`,is,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,t,n){return this._client.delete(`/threads/${e}/messages/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class is extends Y{}as.MessagesPage=is;class os extends R{retrieve(e,t,n,r={},a){return J(r)?this.retrieve(e,t,n,{},r):this._client.get(`/threads/${e}/runs/${t}/steps/${n}`,{query:r,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}list(e,t,n={},r){return J(n)?this.list(e,t,{},n):this._client.getAPIList(`/threads/${e}/runs/${t}/steps`,cs,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class cs extends Y{}os.RunStepsPage=cs;let At=class extends R{constructor(){super(...arguments),this.steps=new os(this._client)}create(e,t,n){const{include:r,...a}=t;return this._client.post(`/threads/${e}/runs`,{query:{include:r},body:a,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers},stream:t.stream??!1})}retrieve(e,t,n){return this._client.get(`/threads/${e}/runs/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,t,n,r){return this._client.post(`/threads/${e}/runs/${t}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(e,t={},n){return J(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/runs`,ls,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}cancel(e,t,n){return this._client.post(`/threads/${e}/runs/${t}/cancel`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async createAndPoll(e,t,n){const r=await this.create(e,t,n);return await this.poll(e,r.id,n)}createAndStream(e,t,n){return pe.createAssistantStream(e,this._client.beta.threads.runs,t,n)}async poll(e,t,n){const r={...n==null?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for(n!=null&&n.pollIntervalMs&&(r["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const{data:a,response:i}=await this.retrieve(e,t,{...n,headers:{...n==null?void 0:n.headers,...r}}).withResponse();switch(a.status){case"queued":case"in_progress":case"cancelling":let o=5e3;if(n!=null&&n.pollIntervalMs)o=n.pollIntervalMs;else{const c=i.headers.get("openai-poll-after-ms");if(c){const l=parseInt(c);isNaN(l)||(o=l)}}await vt(o);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return a}}}stream(e,t,n){return pe.createAssistantStream(e,this._client.beta.threads.runs,t,n)}submitToolOutputs(e,t,n,r){return this._client.post(`/threads/${e}/runs/${t}/submit_tool_outputs`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers},stream:n.stream??!1})}async submitToolOutputsAndPoll(e,t,n,r){const a=await this.submitToolOutputs(e,t,n,r);return await this.poll(e,a.id,r)}submitToolOutputsStream(e,t,n,r){return pe.createToolAssistantStream(e,t,this._client.beta.threads.runs,n,r)}};class ls extends Y{}At.RunsPage=ls;At.Steps=os;At.RunStepsPage=cs;class at extends R{constructor(){super(...arguments),this.runs=new At(this._client),this.messages=new as(this._client)}create(e={},t){return J(e)?this.create({},e):this._client.post("/threads",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}retrieve(e,t){return this._client.get(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}update(e,t,n){return this._client.post(`/threads/${e}`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,t){return this._client.delete(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}createAndRun(e,t){return this._client.post("/threads/runs",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers},stream:e.stream??!1})}async createAndRunPoll(e,t){const n=await this.createAndRun(e,t);return await this.runs.poll(n.thread_id,n.id,t)}createAndRunStream(e,t){return pe.createThreadAssistantStream(e,this._client.beta.threads,t)}}at.Runs=At;at.RunsPage=ls;at.Messages=as;at.MessagesPage=is;class it extends R{constructor(){super(...arguments),this.realtime=new dn(this._client),this.chat=new Un(this._client),this.assistants=new ts(this._client),this.threads=new at(this._client)}}it.Realtime=dn;it.Assistants=ts;it.AssistantsPage=ns;it.Threads=at;class Ea extends R{create(e,t){return this._client.post("/completions",{body:e,...t,stream:e.stream??!1})}}class Oa extends R{retrieve(e,t,n){return this._client.get(`/containers/${e}/files/${t}/content`,{...n,headers:{Accept:"application/binary",...n==null?void 0:n.headers},__binaryResponse:!0})}}let hn=class extends R{constructor(){super(...arguments),this.content=new Oa(this._client)}create(e,t,n){return this._client.post(`/containers/${e}/files`,De({body:t,...n}))}retrieve(e,t,n){return this._client.get(`/containers/${e}/files/${t}`,n)}list(e,t={},n){return J(t)?this.list(e,{},t):this._client.getAPIList(`/containers/${e}/files`,us,{query:t,...n})}del(e,t,n){return this._client.delete(`/containers/${e}/files/${t}`,{...n,headers:{Accept:"*/*",...n==null?void 0:n.headers}})}};class us extends Y{}hn.FileListResponsesPage=us;hn.Content=Oa;class Ct extends R{constructor(){super(...arguments),this.files=new hn(this._client)}create(e,t){return this._client.post("/containers",{body:e,...t})}retrieve(e,t){return this._client.get(`/containers/${e}`,t)}list(e={},t){return J(e)?this.list({},e):this._client.getAPIList("/containers",ds,{query:e,...t})}del(e,t){return this._client.delete(`/containers/${e}`,{...t,headers:{Accept:"*/*",...t==null?void 0:t.headers}})}}class ds extends Y{}Ct.ContainerListResponsesPage=ds;Ct.Files=hn;Ct.FileListResponsesPage=us;class Ta extends R{create(e,t){const n=!!e.encoding_format;let r=n?e.encoding_format:"base64";n&&Ee("Request","User defined encoding_format:",e.encoding_format);const a=this._client.post("/embeddings",{body:{...e,encoding_format:r},...t});return n?a:(Ee("response","Decoding base64 embeddings to float32 array"),a._thenUnwrap(i=>(i&&i.data&&i.data.forEach(o=>{const c=o.embedding;o.embedding=Vi(c)}),i)))}}class hs extends R{retrieve(e,t,n,r){return this._client.get(`/evals/${e}/runs/${t}/output_items/${n}`,r)}list(e,t,n={},r){return J(n)?this.list(e,t,{},n):this._client.getAPIList(`/evals/${e}/runs/${t}/output_items`,fs,{query:n,...r})}}class fs extends Y{}hs.OutputItemListResponsesPage=fs;class Pt extends R{constructor(){super(...arguments),this.outputItems=new hs(this._client)}create(e,t,n){return this._client.post(`/evals/${e}/runs`,{body:t,...n})}retrieve(e,t,n){return this._client.get(`/evals/${e}/runs/${t}`,n)}list(e,t={},n){return J(t)?this.list(e,{},t):this._client.getAPIList(`/evals/${e}/runs`,ms,{query:t,...n})}del(e,t,n){return this._client.delete(`/evals/${e}/runs/${t}`,n)}cancel(e,t,n){return this._client.post(`/evals/${e}/runs/${t}`,n)}}class ms extends Y{}Pt.RunListResponsesPage=ms;Pt.OutputItems=hs;Pt.OutputItemListResponsesPage=fs;class Rt extends R{constructor(){super(...arguments),this.runs=new Pt(this._client)}create(e,t){return this._client.post("/evals",{body:e,...t})}retrieve(e,t){return this._client.get(`/evals/${e}`,t)}update(e,t,n){return this._client.post(`/evals/${e}`,{body:t,...n})}list(e={},t){return J(e)?this.list({},e):this._client.getAPIList("/evals",ps,{query:e,...t})}del(e,t){return this._client.delete(`/evals/${e}`,t)}}class ps extends Y{}Rt.EvalListResponsesPage=ps;Rt.Runs=Pt;Rt.RunListResponsesPage=ms;let gs=class extends R{create(e,t){return this._client.post("/files",De({body:e,...t}))}retrieve(e,t){return this._client.get(`/files/${e}`,t)}list(e={},t){return J(e)?this.list({},e):this._client.getAPIList("/files",ys,{query:e,...t})}del(e,t){return this._client.delete(`/files/${e}`,t)}content(e,t){return this._client.get(`/files/${e}/content`,{...t,headers:{Accept:"application/binary",...t==null?void 0:t.headers},__binaryResponse:!0})}retrieveContent(e,t){return this._client.get(`/files/${e}/content`,t)}async waitForProcessing(e,{pollInterval:t=5e3,maxWait:n=30*60*1e3}={}){const r=new Set(["processed","error","deleted"]),a=Date.now();let i=await this.retrieve(e);for(;!i.status||!r.has(i.status);)if(await vt(t),i=await this.retrieve(e),Date.now()-a>n)throw new Gn({message:`Giving up on waiting for file ${e} to finish processing after ${n} milliseconds.`});return i}};class ys extends Y{}gs.FileObjectsPage=ys;class $a extends R{}let Ia=class extends R{run(e,t){return this._client.post("/fine_tuning/alpha/graders/run",{body:e,...t})}validate(e,t){return this._client.post("/fine_tuning/alpha/graders/validate",{body:e,...t})}};class _s extends R{constructor(){super(...arguments),this.graders=new Ia(this._client)}}_s.Graders=Ia;class bs extends R{create(e,t,n){return this._client.getAPIList(`/fine_tuning/checkpoints/${e}/permissions`,ws,{body:t,method:"post",...n})}retrieve(e,t={},n){return J(t)?this.retrieve(e,{},t):this._client.get(`/fine_tuning/checkpoints/${e}/permissions`,{query:t,...n})}del(e,t,n){return this._client.delete(`/fine_tuning/checkpoints/${e}/permissions/${t}`,n)}}class ws extends on{}bs.PermissionCreateResponsesPage=ws;let fn=class extends R{constructor(){super(...arguments),this.permissions=new bs(this._client)}};fn.Permissions=bs;fn.PermissionCreateResponsesPage=ws;class xs extends R{list(e,t={},n){return J(t)?this.list(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/checkpoints`,vs,{query:t,...n})}}class vs extends Y{}xs.FineTuningJobCheckpointsPage=vs;class ot extends R{constructor(){super(...arguments),this.checkpoints=new xs(this._client)}create(e,t){return this._client.post("/fine_tuning/jobs",{body:e,...t})}retrieve(e,t){return this._client.get(`/fine_tuning/jobs/${e}`,t)}list(e={},t){return J(e)?this.list({},e):this._client.getAPIList("/fine_tuning/jobs",ks,{query:e,...t})}cancel(e,t){return this._client.post(`/fine_tuning/jobs/${e}/cancel`,t)}listEvents(e,t={},n){return J(t)?this.listEvents(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/events`,Ss,{query:t,...n})}pause(e,t){return this._client.post(`/fine_tuning/jobs/${e}/pause`,t)}resume(e,t){return this._client.post(`/fine_tuning/jobs/${e}/resume`,t)}}class ks extends Y{}class Ss extends Y{}ot.FineTuningJobsPage=ks;ot.FineTuningJobEventsPage=Ss;ot.Checkpoints=xs;ot.FineTuningJobCheckpointsPage=vs;class Ie extends R{constructor(){super(...arguments),this.methods=new $a(this._client),this.jobs=new ot(this._client),this.checkpoints=new fn(this._client),this.alpha=new _s(this._client)}}Ie.Methods=$a;Ie.Jobs=ot;Ie.FineTuningJobsPage=ks;Ie.FineTuningJobEventsPage=Ss;Ie.Checkpoints=fn;Ie.Alpha=_s;class Na extends R{}class As extends R{constructor(){super(...arguments),this.graderModels=new Na(this._client)}}As.GraderModels=Na;class ja extends R{createVariation(e,t){return this._client.post("/images/variations",De({body:e,...t}))}edit(e,t){return this._client.post("/images/edits",De({body:e,...t}))}generate(e,t){return this._client.post("/images/generations",{body:e,...t})}}class Cs extends R{retrieve(e,t){return this._client.get(`/models/${e}`,t)}list(e){return this._client.getAPIList("/models",Ps,e)}del(e,t){return this._client.delete(`/models/${e}`,t)}}class Ps extends on{}Cs.ModelsPage=Ps;class Ma extends R{create(e,t){return this._client.post("/moderations",{body:e,...t})}}function so(s,e){return!e||!ao(e)?{...s,output_parsed:null,output:s.output.map(t=>t.type==="function_call"?{...t,parsed_arguments:null}:t.type==="message"?{...t,content:t.content.map(n=>({...n,parsed:null}))}:t)}:La(s,e)}function La(s,e){const t=s.output.map(r=>{if(r.type==="function_call")return{...r,parsed_arguments:co(e,r)};if(r.type==="message"){const a=r.content.map(i=>i.type==="output_text"?{...i,parsed:ro(e,i.text)}:i);return{...r,content:a}}return r}),n=Object.assign({},s,{output:t});return Object.getOwnPropertyDescriptor(s,"output_text")||Fa(n),Object.defineProperty(n,"output_parsed",{enumerable:!0,get(){for(const r of n.output)if(r.type==="message"){for(const a of r.content)if(a.type==="output_text"&&a.parsed!==null)return a.parsed}return null}}),n}function ro(s,e){var t,n,r,a;return((n=(t=s.text)==null?void 0:t.format)==null?void 0:n.type)!=="json_schema"?null:"$parseRaw"in((r=s.text)==null?void 0:r.format)?((a=s.text)==null?void 0:a.format).$parseRaw(e):JSON.parse(e)}function ao(s){var e;return!!ss((e=s.text)==null?void 0:e.format)}function io(s){return(s==null?void 0:s.$brand)==="auto-parseable-tool"}function oo(s,e){return s.find(t=>t.type==="function"&&t.name===e)}function co(s,e){const t=oo(s.tools??[],e.name);return{...e,...e,parsed_arguments:io(t)?t.$parseRaw(e.arguments):t!=null&&t.strict?JSON.parse(e.arguments):null}}function Fa(s){const e=[];for(const t of s.output)if(t.type==="message")for(const n of t.content)n.type==="output_text"&&e.push(n.text);s.output_text=e.join("")}class Da extends R{list(e,t={},n){return J(t)?this.list(e,{},t):this._client.getAPIList(`/responses/${e}/input_items`,uo,{query:t,...n})}}var ze=function(s,e,t,n,r){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?s!==e||!r:!e.has(s))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?r.call(s,t):r?r.value=t:e.set(s,t),t},Ae=function(s,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?s!==e||!n:!e.has(s))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(s):n?n.value:e.get(s)},Je,Mt,Ce,Lt,nr,sr,rr,ar;class Rs extends es{constructor(e){super(),Je.add(this),Mt.set(this,void 0),Ce.set(this,void 0),Lt.set(this,void 0),ze(this,Mt,e,"f")}static createResponse(e,t,n){const r=new Rs(t);return r._run(()=>r._createOrRetrieveResponse(e,t,{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"stream"}})),r}async _createOrRetrieveResponse(e,t,n){var o;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),Ae(this,Je,"m",nr).call(this);let a,i=null;"response_id"in t?(a=await e.responses.retrieve(t.response_id,{stream:!0},{...n,signal:this.controller.signal,stream:!0}),i=t.starting_after??null):a=await e.responses.create({...t,stream:!0},{...n,signal:this.controller.signal}),this._connected();for await(const c of a)Ae(this,Je,"m",sr).call(this,c,i);if((o=a.controller.signal)!=null&&o.aborted)throw new le;return Ae(this,Je,"m",rr).call(this)}[(Mt=new WeakMap,Ce=new WeakMap,Lt=new WeakMap,Je=new WeakSet,nr=function(){this.ended||ze(this,Ce,void 0,"f")},sr=function(t,n){if(this.ended)return;const r=(i,o)=>{(n==null||o.sequence_number>n)&&this._emit(i,o)},a=Ae(this,Je,"m",ar).call(this,t);switch(r("event",t),t.type){case"response.output_text.delta":{const i=a.output[t.output_index];if(!i)throw new P(`missing output at index ${t.output_index}`);if(i.type==="message"){const o=i.content[t.content_index];if(!o)throw new P(`missing content at index ${t.content_index}`);if(o.type!=="output_text")throw new P(`expected content to be 'output_text', got ${o.type}`);r("response.output_text.delta",{...t,snapshot:o.text})}break}case"response.function_call_arguments.delta":{const i=a.output[t.output_index];if(!i)throw new P(`missing output at index ${t.output_index}`);i.type==="function_call"&&r("response.function_call_arguments.delta",{...t,snapshot:i.arguments});break}default:r(t.type,t);break}},rr=function(){if(this.ended)throw new P("stream has ended, this shouldn't happen");const t=Ae(this,Ce,"f");if(!t)throw new P("request ended without sending any events");ze(this,Ce,void 0,"f");const n=lo(t,Ae(this,Mt,"f"));return ze(this,Lt,n,"f"),n},ar=function(t){let n=Ae(this,Ce,"f");if(!n){if(t.type!=="response.created")throw new P(`When snapshot hasn't been set yet, expected 'response.created' event, got ${t.type}`);return n=ze(this,Ce,t.response,"f"),n}switch(t.type){case"response.output_item.added":{n.output.push(t.item);break}case"response.content_part.added":{const r=n.output[t.output_index];if(!r)throw new P(`missing output at index ${t.output_index}`);r.type==="message"&&r.content.push(t.part);break}case"response.output_text.delta":{const r=n.output[t.output_index];if(!r)throw new P(`missing output at index ${t.output_index}`);if(r.type==="message"){const a=r.content[t.content_index];if(!a)throw new P(`missing content at index ${t.content_index}`);if(a.type!=="output_text")throw new P(`expected content to be 'output_text', got ${a.type}`);a.text+=t.delta}break}case"response.function_call_arguments.delta":{const r=n.output[t.output_index];if(!r)throw new P(`missing output at index ${t.output_index}`);r.type==="function_call"&&(r.arguments+=t.delta);break}case"response.completed":{ze(this,Ce,t.response,"f");break}}return n},Symbol.asyncIterator)](){const e=[],t=[];let n=!1;return this.on("event",r=>{const a=t.shift();a?a.resolve(r):e.push(r)}),this.on("end",()=>{n=!0;for(const r of t)r.resolve(void 0);t.length=0}),this.on("abort",r=>{n=!0;for(const a of t)a.reject(r);t.length=0}),this.on("error",r=>{n=!0;for(const a of t)a.reject(r);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:n?{value:void 0,done:!0}:new Promise((a,i)=>t.push({resolve:a,reject:i})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();const e=Ae(this,Lt,"f");if(!e)throw new P("stream ended without producing a ChatCompletion");return e}}function lo(s,e){return so(s,e)}class Es extends R{constructor(){super(...arguments),this.inputItems=new Da(this._client)}create(e,t){return this._client.post("/responses",{body:e,...t,stream:e.stream??!1})._thenUnwrap(n=>("object"in n&&n.object==="response"&&Fa(n),n))}retrieve(e,t={},n){return this._client.get(`/responses/${e}`,{query:t,...n,stream:(t==null?void 0:t.stream)??!1})}del(e,t){return this._client.delete(`/responses/${e}`,{...t,headers:{Accept:"*/*",...t==null?void 0:t.headers}})}parse(e,t){return this._client.responses.create(e,t)._thenUnwrap(n=>La(n,e))}stream(e,t){return Rs.createResponse(this._client,e,t)}cancel(e,t){return this._client.post(`/responses/${e}/cancel`,{...t,headers:{Accept:"*/*",...t==null?void 0:t.headers}})}}class uo extends Y{}Es.InputItems=Da;class Za extends R{create(e,t,n){return this._client.post(`/uploads/${e}/parts`,De({body:t,...n}))}}class Os extends R{constructor(){super(...arguments),this.parts=new Za(this._client)}create(e,t){return this._client.post("/uploads",{body:e,...t})}cancel(e,t){return this._client.post(`/uploads/${e}/cancel`,t)}complete(e,t,n){return this._client.post(`/uploads/${e}/complete`,{body:t,...n})}}Os.Parts=Za;const ho=async s=>{const e=await Promise.allSettled(s),t=e.filter(r=>r.status==="rejected");if(t.length){for(const r of t)console.error(r.reason);throw new Error(`${t.length} promise(s) failed - see the above errors`)}const n=[];for(const r of e)r.status==="fulfilled"&&n.push(r.value);return n};class mn extends R{create(e,t,n){return this._client.post(`/vector_stores/${e}/files`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,t,n){return this._client.get(`/vector_stores/${e}/files/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,t,n,r){return this._client.post(`/vector_stores/${e}/files/${t}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(e,t={},n){return J(t)?this.list(e,{},t):this._client.getAPIList(`/vector_stores/${e}/files`,pn,{query:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,t,n){return this._client.delete(`/vector_stores/${e}/files/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async createAndPoll(e,t,n){const r=await this.create(e,t,n);return await this.poll(e,r.id,n)}async poll(e,t,n){const r={...n==null?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for(n!=null&&n.pollIntervalMs&&(r["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const a=await this.retrieve(e,t,{...n,headers:r}).withResponse(),i=a.data;switch(i.status){case"in_progress":let o=5e3;if(n!=null&&n.pollIntervalMs)o=n.pollIntervalMs;else{const c=a.response.headers.get("openai-poll-after-ms");if(c){const l=parseInt(c);isNaN(l)||(o=l)}}await vt(o);break;case"failed":case"completed":return i}}}async upload(e,t,n){const r=await this._client.files.create({file:t,purpose:"assistants"},n);return this.create(e,{file_id:r.id},n)}async uploadAndPoll(e,t,n){const r=await this.upload(e,t,n);return await this.poll(e,r.id,n)}content(e,t,n){return this._client.getAPIList(`/vector_stores/${e}/files/${t}/content`,Ts,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class pn extends Y{}class Ts extends on{}mn.VectorStoreFilesPage=pn;mn.FileContentResponsesPage=Ts;class Ba extends R{create(e,t,n){return this._client.post(`/vector_stores/${e}/file_batches`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,t,n){return this._client.get(`/vector_stores/${e}/file_batches/${t}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}cancel(e,t,n){return this._client.post(`/vector_stores/${e}/file_batches/${t}/cancel`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}async createAndPoll(e,t,n){const r=await this.create(e,t);return await this.poll(e,r.id,n)}listFiles(e,t,n={},r){return J(n)?this.listFiles(e,t,{},n):this._client.getAPIList(`/vector_stores/${e}/file_batches/${t}/files`,pn,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async poll(e,t,n){const r={...n==null?void 0:n.headers,"X-Stainless-Poll-Helper":"true"};for(n!=null&&n.pollIntervalMs&&(r["X-Stainless-Custom-Poll-Interval"]=n.pollIntervalMs.toString());;){const{data:a,response:i}=await this.retrieve(e,t,{...n,headers:r}).withResponse();switch(a.status){case"in_progress":let o=5e3;if(n!=null&&n.pollIntervalMs)o=n.pollIntervalMs;else{const c=i.headers.get("openai-poll-after-ms");if(c){const l=parseInt(c);isNaN(l)||(o=l)}}await vt(o);break;case"failed":case"cancelled":case"completed":return a}}}async uploadAndPoll(e,{files:t,fileIds:n=[]},r){if(t==null||t.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const a=(r==null?void 0:r.maxConcurrency)??5,i=Math.min(a,t.length),o=this._client,c=t.values(),l=[...n];async function u(d){for(let y of d){const _=await o.files.create({file:y,purpose:"assistants"},r);l.push(_.id)}}const h=Array(i).fill(c).map(u);return await ho(h),await this.createAndPoll(e,{file_ids:l})}}class Ne extends R{constructor(){super(...arguments),this.files=new mn(this._client),this.fileBatches=new Ba(this._client)}create(e,t){return this._client.post("/vector_stores",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}retrieve(e,t){return this._client.get(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}update(e,t,n){return this._client.post(`/vector_stores/${e}`,{body:t,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}list(e={},t){return J(e)?this.list({},e):this._client.getAPIList("/vector_stores",$s,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}del(e,t){return this._client.delete(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}search(e,t,n){return this._client.getAPIList(`/vector_stores/${e}/search`,Is,{body:t,method:"post",...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class $s extends Y{}class Is extends on{}Ne.VectorStoresPage=$s;Ne.VectorStoreSearchResponsesPage=Is;Ne.Files=mn;Ne.VectorStoreFilesPage=pn;Ne.FileContentResponsesPage=Ts;Ne.FileBatches=Ba;var Ua;class E extends Ti{constructor({baseURL:e=Tt("OPENAI_BASE_URL"),apiKey:t=Tt("OPENAI_API_KEY"),organization:n=Tt("OPENAI_ORG_ID")??null,project:r=Tt("OPENAI_PROJECT_ID")??null,...a}={}){if(t===void 0)throw new P("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const i={apiKey:t,organization:n,project:r,...a,baseURL:e||"https://api.openai.com/v1"};if(!i.dangerouslyAllowBrowser&&Bi())throw new P(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);super({baseURL:i.baseURL,timeout:i.timeout??6e5,httpAgent:i.httpAgent,maxRetries:i.maxRetries,fetch:i.fetch}),this.completions=new Ea(this),this.chat=new un(this),this.embeddings=new Ta(this),this.files=new gs(this),this.images=new ja(this),this.audio=new kt(this),this.moderations=new Ma(this),this.models=new Cs(this),this.fineTuning=new Ie(this),this.graders=new As(this),this.vectorStores=new Ne(this),this.beta=new it(this),this.batches=new Yn(this),this.uploads=new Os(this),this.responses=new Es(this),this.evals=new Rt(this),this.containers=new Ct(this),this._options=i,this.apiKey=t,this.organization=n,this.project=r}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(e){return fi(e,{arrayFormat:"brackets"})}}Ua=E;E.OpenAI=Ua;E.DEFAULT_TIMEOUT=6e5;E.OpenAIError=P;E.APIError=te;E.APIConnectionError=nn;E.APIConnectionTimeoutError=Gn;E.APIUserAbortError=le;E.NotFoundError=Zr;E.ConflictError=Br;E.RateLimitError=Vr;E.BadRequestError=Lr;E.AuthenticationError=Fr;E.InternalServerError=Wr;E.PermissionDeniedError=Dr;E.UnprocessableEntityError=Ur;E.toFile=Kr;E.fileFromPath=Nr;E.Completions=Ea;E.Chat=un;E.ChatCompletionsPage=ln;E.Embeddings=Ta;E.Files=gs;E.FileObjectsPage=ys;E.Images=ja;E.Audio=kt;E.Moderations=Ma;E.Models=Cs;E.ModelsPage=Ps;E.FineTuning=Ie;E.Graders=As;E.VectorStores=Ne;E.VectorStoresPage=$s;E.VectorStoreSearchResponsesPage=Is;E.Beta=it;E.Batches=Yn;E.BatchesPage=Qn;E.Uploads=Os;E.Responses=Es;E.Evals=Rt;E.EvalListResponsesPage=ps;E.Containers=Ct;E.ContainerListResponsesPage=ds;/*! js-cookie v3.0.5 | MIT */function Ft(s){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)s[n]=t[n]}return s}var fo={read:function(s){return s[0]==='"'&&(s=s.slice(1,-1)),s.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(s){return encodeURIComponent(s).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function Vn(s,e){function t(r,a,i){if(!(typeof document>"u")){i=Ft({},e,i),typeof i.expires=="number"&&(i.expires=new Date(Date.now()+i.expires*864e5)),i.expires&&(i.expires=i.expires.toUTCString()),r=encodeURIComponent(r).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var o="";for(var c in i)i[c]&&(o+="; "+c,i[c]!==!0&&(o+="="+i[c].split(";")[0]));return document.cookie=r+"="+s.write(a,r)+o}}function n(r){if(!(typeof document>"u"||arguments.length&&!r)){for(var a=document.cookie?document.cookie.split("; "):[],i={},o=0;o<a.length;o++){var c=a[o].split("="),l=c.slice(1).join("=");try{var u=decodeURIComponent(c[0]);if(i[u]=s.read(l,u),r===u)break}catch{}}return r?i[r]:i}}return Object.create({set:t,get:n,remove:function(r,a){t(r,"",Ft({},a,{expires:-1}))},withAttributes:function(r){return Vn(this.converter,Ft({},this.attributes,r))},withConverter:function(r){return Vn(Ft({},this.converter,r),this.attributes)}},{attributes:{value:Object.freeze(e)},converter:{value:Object.freeze(s)}})}var Xe=Vn(fo,{path:"/"});function mo(){const[s,e]=D.useState(""),[t,n]=D.useState(!1),[r,a]=D.useState(null),[i,o]=D.useState(!1),[c,l]=D.useState(!1);D.useEffect(()=>{const d=Xe.get("openai_api_key");d&&(e(d),n(!0))},[]);const u=async()=>{o(!0),a(null),l(!1);try{const y=await new E({apiKey:s,dangerouslyAllowBrowser:!0}).responses.create({model:"gpt-4.1-nano",input:"Say hello"});y&&y.output_text?(a({message:"API key is valid.",status:"success"}),Xe.set("openai_api_key",s,{expires:30,secure:!0,sameSite:"strict"}),n(!0)):(a({message:"API key is invalid or request failed.",status:"error"}),Xe.remove("openai_api_key"),n(!1)),setTimeout(()=>{l(!0)},2500),setTimeout(()=>{a(null),l(!1)},3e3)}catch(d){const _=d&&/Network|Failed to fetch/i.test(d.message)?"Network error while validating API key. Please check your connection.":`API key is invalid or request failed: ${d.message}`;a({message:_,status:"error"}),Xe.remove("openai_api_key"),n(!1),setTimeout(()=>{l(!0)},2500),setTimeout(()=>{a(null),l(!1)},3e3)}finally{o(!1)}},h=()=>{Xe.remove("openai_api_key"),e(""),a({message:"API key deleted.",status:"success"}),n(!1),l(!1),setTimeout(()=>{l(!0)},2500),setTimeout(()=>{a(null),l(!1)},3e3)};return p.jsxs("main",{className:"max-w-3xl mx-auto p-8 bg-white rounded-lg shadow-lg mt-10 font-secondary",children:[p.jsx("h2",{className:"text-3xl font-extrabold mb-6 text-gray-900 font-primary",children:"Set up your OpenAI API key"}),p.jsx("label",{htmlFor:"api-key-input",className:"block mb-2 text-gray-700 font-medium",children:"OpenAI API key"}),p.jsx("input",{id:"api-key-input",type:"text",placeholder:"Enter your OpenAI API key",value:s,onChange:d=>e(d.target.value),className:"w-full p-3 border border-gray-300 rounded-lg mb-6 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition"}),p.jsx("button",{onClick:u,disabled:i||!s,className:"w-full py-3 bg-primary-600 hover:bg-primary-700 focus:ring-4 focus:ring-primary-300 text-white font-semibold rounded-lg disabled:opacity-50 disabled:cursor-not-allowed transition flex items-center justify-center",children:i?p.jsxs(p.Fragment,{children:[p.jsx(Kn,{}),"Checking..."]}):"Check and save API Key"}),s&&t&&p.jsxs("div",{className:"mt-6 flex justify-between items-center bg-green-100 border border-green-400 text-green-900 p-4 rounded-lg",children:[p.jsx("p",{className:"text-lg font-medium",children:"API key is loaded from cookie."}),p.jsx("button",{onClick:h,className:"ml-4 py-2 px-4 bg-green-500 hover:bg-green-600 text-white font-semibold rounded-lg transition",children:"Delete Key"})]}),r&&p.jsxs("p",{className:`mt-6 p-4 rounded-lg flex items-center text-lg font-medium transition-opacity duration-500 ${c?"opacity-0":"opacity-100"} ${r.status==="success"?"bg-green-100 text-green-900 border border-green-400":"bg-red-100 text-red-900 border border-red-400"}`,role:"alert",children:[r.status==="success"?p.jsx("svg",{className:"w-6 h-6 mr-3 text-green-600",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:p.jsx("path",{d:"M7.629 13.314l-3.292-3.292-1.414 1.414 4.706 4.706 9-9-1.414-1.414z"})}):p.jsx("svg",{className:"w-6 h-6 mr-3 text-red-600",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:p.jsx("path",{d:"M10 8.586l4.95-4.95 1.414 1.414L11.414 10l4.95 4.95-1.414 1.414L10 11.414l-4.95 4.95-1.414-1.414L8.586 10 3.636 5.05l1.414-1.414L10 8.586z"})}),r.message]})]})}const po=Symbol("Let zodToJsonSchema decide on which parser to use"),ir={name:void 0,$refStrategy:"root",effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",nullableStrategy:"from-target",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},go=s=>typeof s=="string"?{...ir,basePath:["#"],definitions:{},name:s}:{...ir,basePath:["#"],definitions:{},...s},Wn=s=>"_def"in s?s._def:s;function yo(s){if(!s)return!0;for(const e in s)return!1;return!0}const _o=s=>{const e=go(s),t=e.name!==void 0?[...e.basePath,e.definitionPath,e.name]:e.basePath;return{...e,currentPath:t,propertyPath:void 0,seenRefs:new Set,seen:new Map(Object.entries(e.definitions).map(([n,r])=>[Wn(r),{def:Wn(r),path:[...e.basePath,e.definitionPath,n],jsonSchema:void 0}]))}};function Va(s,e,t,n){n!=null&&n.errorMessages&&t&&(s.errorMessage={...s.errorMessage,[e]:t})}function B(s,e,t,n,r){s[e]=t,Va(s,e,n,r)}var M;(function(s){s.assertEqual=r=>{};function e(r){}s.assertIs=e;function t(r){throw new Error}s.assertNever=t,s.arrayToEnum=r=>{const a={};for(const i of r)a[i]=i;return a},s.getValidEnumValues=r=>{const a=s.objectKeys(r).filter(o=>typeof r[r[o]]!="number"),i={};for(const o of a)i[o]=r[o];return s.objectValues(i)},s.objectValues=r=>s.objectKeys(r).map(function(a){return r[a]}),s.objectKeys=typeof Object.keys=="function"?r=>Object.keys(r):r=>{const a=[];for(const i in r)Object.prototype.hasOwnProperty.call(r,i)&&a.push(i);return a},s.find=(r,a)=>{for(const i of r)if(a(i))return i},s.isInteger=typeof Number.isInteger=="function"?r=>Number.isInteger(r):r=>typeof r=="number"&&Number.isFinite(r)&&Math.floor(r)===r;function n(r,a=" | "){return r.map(i=>typeof i=="string"?`'${i}'`:i).join(a)}s.joinValues=n,s.jsonStringifyReplacer=(r,a)=>typeof a=="bigint"?a.toString():a})(M||(M={}));var or;(function(s){s.mergeShapes=(e,t)=>({...e,...t})})(or||(or={}));const v=M.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Pe=s=>{switch(typeof s){case"undefined":return v.undefined;case"string":return v.string;case"number":return Number.isNaN(s)?v.nan:v.number;case"boolean":return v.boolean;case"function":return v.function;case"bigint":return v.bigint;case"symbol":return v.symbol;case"object":return Array.isArray(s)?v.array:s===null?v.null:s.then&&typeof s.then=="function"&&s.catch&&typeof s.catch=="function"?v.promise:typeof Map<"u"&&s instanceof Map?v.map:typeof Set<"u"&&s instanceof Set?v.set:typeof Date<"u"&&s instanceof Date?v.date:v.object;default:return v.unknown}},f=M.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class ke extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){const t=e||function(a){return a.message},n={_errors:[]},r=a=>{for(const i of a.issues)if(i.code==="invalid_union")i.unionErrors.map(r);else if(i.code==="invalid_return_type")r(i.returnTypeError);else if(i.code==="invalid_arguments")r(i.argumentsError);else if(i.path.length===0)n._errors.push(t(i));else{let o=n,c=0;for(;c<i.path.length;){const l=i.path[c];c===i.path.length-1?(o[l]=o[l]||{_errors:[]},o[l]._errors.push(t(i))):o[l]=o[l]||{_errors:[]},o=o[l],c++}}};return r(this),n}static assert(e){if(!(e instanceof ke))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,M.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){const t={},n=[];for(const r of this.issues)r.path.length>0?(t[r.path[0]]=t[r.path[0]]||[],t[r.path[0]].push(e(r))):n.push(e(r));return{formErrors:n,fieldErrors:t}}get formErrors(){return this.flatten()}}ke.create=s=>new ke(s);const zn=(s,e)=>{let t;switch(s.code){case f.invalid_type:s.received===v.undefined?t="Required":t=`Expected ${s.expected}, received ${s.received}`;break;case f.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(s.expected,M.jsonStringifyReplacer)}`;break;case f.unrecognized_keys:t=`Unrecognized key(s) in object: ${M.joinValues(s.keys,", ")}`;break;case f.invalid_union:t="Invalid input";break;case f.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${M.joinValues(s.options)}`;break;case f.invalid_enum_value:t=`Invalid enum value. Expected ${M.joinValues(s.options)}, received '${s.received}'`;break;case f.invalid_arguments:t="Invalid function arguments";break;case f.invalid_return_type:t="Invalid function return type";break;case f.invalid_date:t="Invalid date";break;case f.invalid_string:typeof s.validation=="object"?"includes"in s.validation?(t=`Invalid input: must include "${s.validation.includes}"`,typeof s.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${s.validation.position}`)):"startsWith"in s.validation?t=`Invalid input: must start with "${s.validation.startsWith}"`:"endsWith"in s.validation?t=`Invalid input: must end with "${s.validation.endsWith}"`:M.assertNever(s.validation):s.validation!=="regex"?t=`Invalid ${s.validation}`:t="Invalid";break;case f.too_small:s.type==="array"?t=`Array must contain ${s.exact?"exactly":s.inclusive?"at least":"more than"} ${s.minimum} element(s)`:s.type==="string"?t=`String must contain ${s.exact?"exactly":s.inclusive?"at least":"over"} ${s.minimum} character(s)`:s.type==="number"?t=`Number must be ${s.exact?"exactly equal to ":s.inclusive?"greater than or equal to ":"greater than "}${s.minimum}`:s.type==="date"?t=`Date must be ${s.exact?"exactly equal to ":s.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(s.minimum))}`:t="Invalid input";break;case f.too_big:s.type==="array"?t=`Array must contain ${s.exact?"exactly":s.inclusive?"at most":"less than"} ${s.maximum} element(s)`:s.type==="string"?t=`String must contain ${s.exact?"exactly":s.inclusive?"at most":"under"} ${s.maximum} character(s)`:s.type==="number"?t=`Number must be ${s.exact?"exactly":s.inclusive?"less than or equal to":"less than"} ${s.maximum}`:s.type==="bigint"?t=`BigInt must be ${s.exact?"exactly":s.inclusive?"less than or equal to":"less than"} ${s.maximum}`:s.type==="date"?t=`Date must be ${s.exact?"exactly":s.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(s.maximum))}`:t="Invalid input";break;case f.custom:t="Invalid input";break;case f.invalid_intersection_types:t="Intersection results could not be merged";break;case f.not_multiple_of:t=`Number must be a multiple of ${s.multipleOf}`;break;case f.not_finite:t="Number must be finite";break;default:t=e.defaultError,M.assertNever(s)}return{message:t}};let bo=zn;function wo(){return bo}const xo=s=>{const{data:e,path:t,errorMaps:n,issueData:r}=s,a=[...t,...r.path||[]],i={...r,path:a};if(r.message!==void 0)return{...r,path:a,message:r.message};let o="";const c=n.filter(l=>!!l).slice().reverse();for(const l of c)o=l(i,{data:e,defaultError:o}).message;return{...r,path:a,message:o}};function b(s,e){const t=wo(),n=xo({issueData:e,data:s.data,path:s.path,errorMaps:[s.common.contextualErrorMap,s.schemaErrorMap,t,t===zn?void 0:zn].filter(r=>!!r)});s.common.issues.push(n)}class ce{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){const n=[];for(const r of t){if(r.status==="aborted")return O;r.status==="dirty"&&e.dirty(),n.push(r.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,t){const n=[];for(const r of t){const a=await r.key,i=await r.value;n.push({key:a,value:i})}return ce.mergeObjectSync(e,n)}static mergeObjectSync(e,t){const n={};for(const r of t){const{key:a,value:i}=r;if(a.status==="aborted"||i.status==="aborted")return O;a.status==="dirty"&&e.dirty(),i.status==="dirty"&&e.dirty(),a.value!=="__proto__"&&(typeof i.value<"u"||r.alwaysSet)&&(n[a.value]=i.value)}return{status:e.value,value:n}}}const O=Object.freeze({status:"aborted"}),mt=s=>({status:"dirty",value:s}),ue=s=>({status:"valid",value:s}),cr=s=>s.status==="aborted",lr=s=>s.status==="dirty",tt=s=>s.status==="valid",Kt=s=>typeof Promise<"u"&&s instanceof Promise;var k;(function(s){s.errToObj=e=>typeof e=="string"?{message:e}:e||{},s.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(k||(k={}));class Te{constructor(e,t,n,r){this._cachedPath=[],this.parent=e,this.data=t,this._path=n,this._key=r}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const ur=(s,e)=>{if(tt(e))return{success:!0,data:e.value};if(!s.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new ke(s.common.issues);return this._error=t,this._error}}};function $(s){if(!s)return{};const{errorMap:e,invalid_type_error:t,required_error:n,description:r}=s;if(e&&(t||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:r}:{errorMap:(i,o)=>{const{message:c}=s;return i.code==="invalid_enum_value"?{message:c??o.defaultError}:typeof o.data>"u"?{message:c??n??o.defaultError}:i.code!=="invalid_type"?{message:o.defaultError}:{message:c??t??o.defaultError}},description:r}}class j{get description(){return this._def.description}_getType(e){return Pe(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:Pe(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new ce,ctx:{common:e.parent.common,data:e.data,parsedType:Pe(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(Kt(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const n=this.safeParse(e,t);if(n.success)return n.data;throw n.error}safeParse(e,t){const n={common:{issues:[],async:(t==null?void 0:t.async)??!1,contextualErrorMap:t==null?void 0:t.errorMap},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Pe(e)},r=this._parseSync({data:e,path:n.path,parent:n});return ur(n,r)}"~validate"(e){var n,r;const t={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Pe(e)};if(!this["~standard"].async)try{const a=this._parseSync({data:e,path:[],parent:t});return tt(a)?{value:a.value}:{issues:t.common.issues}}catch(a){(r=(n=a==null?void 0:a.message)==null?void 0:n.toLowerCase())!=null&&r.includes("encountered")&&(this["~standard"].async=!0),t.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:t}).then(a=>tt(a)?{value:a.value}:{issues:t.common.issues})}async parseAsync(e,t){const n=await this.safeParseAsync(e,t);if(n.success)return n.data;throw n.error}async safeParseAsync(e,t){const n={common:{issues:[],contextualErrorMap:t==null?void 0:t.errorMap,async:!0},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Pe(e)},r=this._parse({data:e,path:n.path,parent:n}),a=await(Kt(r)?r:Promise.resolve(r));return ur(n,a)}refine(e,t){const n=r=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(r):t;return this._refinement((r,a)=>{const i=e(r),o=()=>a.addIssue({code:f.custom,...n(r)});return typeof Promise<"u"&&i instanceof Promise?i.then(c=>c?!0:(o(),!1)):i?!0:(o(),!1)})}refinement(e,t){return this._refinement((n,r)=>e(n)?!0:(r.addIssue(typeof t=="function"?t(n,r):t),!1))}_refinement(e){return new st({schema:this,typeName:m.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:t=>this["~validate"](t)}}optional(){return Oe.create(this,this._def)}nullable(){return rt.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return we.create(this)}promise(){return en.create(this,this._def)}or(e){return Yt.create([this,e],this._def)}and(e){return Qt.create(this,e,this._def)}transform(e){return new st({...$(this._def),schema:this,typeName:m.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t=typeof e=="function"?e:()=>e;return new Hn({...$(this._def),innerType:this,defaultValue:t,typeName:m.ZodDefault})}brand(){return new Wo({typeName:m.ZodBranded,type:this,...$(this._def)})}catch(e){const t=typeof e=="function"?e:()=>e;return new qn({...$(this._def),innerType:this,catchValue:t,typeName:m.ZodCatch})}describe(e){const t=this.constructor;return new t({...this._def,description:e})}pipe(e){return Ns.create(this,e)}readonly(){return Xn.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const vo=/^c[^\s-]{8,}$/i,ko=/^[0-9a-z]+$/,So=/^[0-9A-HJKMNP-TV-Z]{26}$/i,Ao=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Co=/^[a-z0-9_-]{21}$/i,Po=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,Ro=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,Eo=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,Oo="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let Pn;const To=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,$o=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Io=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,No=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,jo=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Mo=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Wa="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",Lo=new RegExp(`^${Wa}$`);function za(s){let e="[0-5]\\d";s.precision?e=`${e}\\.\\d{${s.precision}}`:s.precision==null&&(e=`${e}(\\.\\d+)?`);const t=s.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${t}`}function Fo(s){return new RegExp(`^${za(s)}$`)}function Do(s){let e=`${Wa}T${za(s)}`;const t=[];return t.push(s.local?"Z?":"Z"),s.offset&&t.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${t.join("|")})`,new RegExp(`^${e}$`)}function Zo(s,e){return!!((e==="v4"||!e)&&To.test(s)||(e==="v6"||!e)&&Io.test(s))}function Bo(s,e){if(!Po.test(s))return!1;try{const[t]=s.split("."),n=t.replace(/-/g,"+").replace(/_/g,"/").padEnd(t.length+(4-t.length%4)%4,"="),r=JSON.parse(atob(n));return!(typeof r!="object"||r===null||"typ"in r&&(r==null?void 0:r.typ)!=="JWT"||!r.alg||e&&r.alg!==e)}catch{return!1}}function Uo(s,e){return!!((e==="v4"||!e)&&$o.test(s)||(e==="v6"||!e)&&No.test(s))}class Re extends j{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==v.string){const a=this._getOrReturnCtx(e);return b(a,{code:f.invalid_type,expected:v.string,received:a.parsedType}),O}const n=new ce;let r;for(const a of this._def.checks)if(a.kind==="min")e.data.length<a.value&&(r=this._getOrReturnCtx(e,r),b(r,{code:f.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),n.dirty());else if(a.kind==="max")e.data.length>a.value&&(r=this._getOrReturnCtx(e,r),b(r,{code:f.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),n.dirty());else if(a.kind==="length"){const i=e.data.length>a.value,o=e.data.length<a.value;(i||o)&&(r=this._getOrReturnCtx(e,r),i?b(r,{code:f.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}):o&&b(r,{code:f.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}),n.dirty())}else if(a.kind==="email")Eo.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"email",code:f.invalid_string,message:a.message}),n.dirty());else if(a.kind==="emoji")Pn||(Pn=new RegExp(Oo,"u")),Pn.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"emoji",code:f.invalid_string,message:a.message}),n.dirty());else if(a.kind==="uuid")Ao.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"uuid",code:f.invalid_string,message:a.message}),n.dirty());else if(a.kind==="nanoid")Co.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"nanoid",code:f.invalid_string,message:a.message}),n.dirty());else if(a.kind==="cuid")vo.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"cuid",code:f.invalid_string,message:a.message}),n.dirty());else if(a.kind==="cuid2")ko.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"cuid2",code:f.invalid_string,message:a.message}),n.dirty());else if(a.kind==="ulid")So.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"ulid",code:f.invalid_string,message:a.message}),n.dirty());else if(a.kind==="url")try{new URL(e.data)}catch{r=this._getOrReturnCtx(e,r),b(r,{validation:"url",code:f.invalid_string,message:a.message}),n.dirty()}else a.kind==="regex"?(a.regex.lastIndex=0,a.regex.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"regex",code:f.invalid_string,message:a.message}),n.dirty())):a.kind==="trim"?e.data=e.data.trim():a.kind==="includes"?e.data.includes(a.value,a.position)||(r=this._getOrReturnCtx(e,r),b(r,{code:f.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),n.dirty()):a.kind==="toLowerCase"?e.data=e.data.toLowerCase():a.kind==="toUpperCase"?e.data=e.data.toUpperCase():a.kind==="startsWith"?e.data.startsWith(a.value)||(r=this._getOrReturnCtx(e,r),b(r,{code:f.invalid_string,validation:{startsWith:a.value},message:a.message}),n.dirty()):a.kind==="endsWith"?e.data.endsWith(a.value)||(r=this._getOrReturnCtx(e,r),b(r,{code:f.invalid_string,validation:{endsWith:a.value},message:a.message}),n.dirty()):a.kind==="datetime"?Do(a).test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{code:f.invalid_string,validation:"datetime",message:a.message}),n.dirty()):a.kind==="date"?Lo.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{code:f.invalid_string,validation:"date",message:a.message}),n.dirty()):a.kind==="time"?Fo(a).test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{code:f.invalid_string,validation:"time",message:a.message}),n.dirty()):a.kind==="duration"?Ro.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"duration",code:f.invalid_string,message:a.message}),n.dirty()):a.kind==="ip"?Zo(e.data,a.version)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"ip",code:f.invalid_string,message:a.message}),n.dirty()):a.kind==="jwt"?Bo(e.data,a.alg)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"jwt",code:f.invalid_string,message:a.message}),n.dirty()):a.kind==="cidr"?Uo(e.data,a.version)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"cidr",code:f.invalid_string,message:a.message}),n.dirty()):a.kind==="base64"?jo.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"base64",code:f.invalid_string,message:a.message}),n.dirty()):a.kind==="base64url"?Mo.test(e.data)||(r=this._getOrReturnCtx(e,r),b(r,{validation:"base64url",code:f.invalid_string,message:a.message}),n.dirty()):M.assertNever(a);return{status:n.value,value:e.data}}_regex(e,t,n){return this.refinement(r=>e.test(r),{validation:t,code:f.invalid_string,...k.errToObj(n)})}_addCheck(e){return new Re({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...k.errToObj(e)})}url(e){return this._addCheck({kind:"url",...k.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...k.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...k.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...k.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...k.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...k.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...k.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...k.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...k.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...k.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...k.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...k.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(e==null?void 0:e.offset)??!1,local:(e==null?void 0:e.local)??!1,...k.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...k.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...k.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...k.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t==null?void 0:t.position,...k.errToObj(t==null?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...k.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...k.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...k.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...k.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...k.errToObj(t)})}nonempty(e){return this.min(1,k.errToObj(e))}trim(){return new Re({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Re({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Re({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}Re.create=s=>new Re({checks:[],typeName:m.ZodString,coerce:(s==null?void 0:s.coerce)??!1,...$(s)});function Vo(s,e){const t=(s.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,r=t>n?t:n,a=Number.parseInt(s.toFixed(r).replace(".","")),i=Number.parseInt(e.toFixed(r).replace(".",""));return a%i/10**r}class bt extends j{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==v.number){const a=this._getOrReturnCtx(e);return b(a,{code:f.invalid_type,expected:v.number,received:a.parsedType}),O}let n;const r=new ce;for(const a of this._def.checks)a.kind==="int"?M.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),b(n,{code:f.invalid_type,expected:"integer",received:"float",message:a.message}),r.dirty()):a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(n=this._getOrReturnCtx(e,n),b(n,{code:f.too_small,minimum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),r.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(n=this._getOrReturnCtx(e,n),b(n,{code:f.too_big,maximum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),r.dirty()):a.kind==="multipleOf"?Vo(e.data,a.value)!==0&&(n=this._getOrReturnCtx(e,n),b(n,{code:f.not_multiple_of,multipleOf:a.value,message:a.message}),r.dirty()):a.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),b(n,{code:f.not_finite,message:a.message}),r.dirty()):M.assertNever(a);return{status:r.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,k.toString(t))}gt(e,t){return this.setLimit("min",e,!1,k.toString(t))}lte(e,t){return this.setLimit("max",e,!0,k.toString(t))}lt(e,t){return this.setLimit("max",e,!1,k.toString(t))}setLimit(e,t,n,r){return new bt({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:k.toString(r)}]})}_addCheck(e){return new bt({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:k.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:k.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:k.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:k.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:k.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:k.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:k.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:k.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:k.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&M.isInteger(e.value))}get isFinite(){let e=null,t=null;for(const n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(t===null||n.value>t)&&(t=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(t)&&Number.isFinite(e)}}bt.create=s=>new bt({checks:[],typeName:m.ZodNumber,coerce:(s==null?void 0:s.coerce)||!1,...$(s)});class wt extends j{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==v.bigint)return this._getInvalidInput(e);let n;const r=new ce;for(const a of this._def.checks)a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(n=this._getOrReturnCtx(e,n),b(n,{code:f.too_small,type:"bigint",minimum:a.value,inclusive:a.inclusive,message:a.message}),r.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(n=this._getOrReturnCtx(e,n),b(n,{code:f.too_big,type:"bigint",maximum:a.value,inclusive:a.inclusive,message:a.message}),r.dirty()):a.kind==="multipleOf"?e.data%a.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),b(n,{code:f.not_multiple_of,multipleOf:a.value,message:a.message}),r.dirty()):M.assertNever(a);return{status:r.value,value:e.data}}_getInvalidInput(e){const t=this._getOrReturnCtx(e);return b(t,{code:f.invalid_type,expected:v.bigint,received:t.parsedType}),O}gte(e,t){return this.setLimit("min",e,!0,k.toString(t))}gt(e,t){return this.setLimit("min",e,!1,k.toString(t))}lte(e,t){return this.setLimit("max",e,!0,k.toString(t))}lt(e,t){return this.setLimit("max",e,!1,k.toString(t))}setLimit(e,t,n,r){return new wt({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:k.toString(r)}]})}_addCheck(e){return new wt({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:k.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:k.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:k.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:k.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:k.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}wt.create=s=>new wt({checks:[],typeName:m.ZodBigInt,coerce:(s==null?void 0:s.coerce)??!1,...$(s)});class dr extends j{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==v.boolean){const n=this._getOrReturnCtx(e);return b(n,{code:f.invalid_type,expected:v.boolean,received:n.parsedType}),O}return ue(e.data)}}dr.create=s=>new dr({typeName:m.ZodBoolean,coerce:(s==null?void 0:s.coerce)||!1,...$(s)});class Gt extends j{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==v.date){const a=this._getOrReturnCtx(e);return b(a,{code:f.invalid_type,expected:v.date,received:a.parsedType}),O}if(Number.isNaN(e.data.getTime())){const a=this._getOrReturnCtx(e);return b(a,{code:f.invalid_date}),O}const n=new ce;let r;for(const a of this._def.checks)a.kind==="min"?e.data.getTime()<a.value&&(r=this._getOrReturnCtx(e,r),b(r,{code:f.too_small,message:a.message,inclusive:!0,exact:!1,minimum:a.value,type:"date"}),n.dirty()):a.kind==="max"?e.data.getTime()>a.value&&(r=this._getOrReturnCtx(e,r),b(r,{code:f.too_big,message:a.message,inclusive:!0,exact:!1,maximum:a.value,type:"date"}),n.dirty()):M.assertNever(a);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Gt({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:k.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:k.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}}Gt.create=s=>new Gt({checks:[],coerce:(s==null?void 0:s.coerce)||!1,typeName:m.ZodDate,...$(s)});class hr extends j{_parse(e){if(this._getType(e)!==v.symbol){const n=this._getOrReturnCtx(e);return b(n,{code:f.invalid_type,expected:v.symbol,received:n.parsedType}),O}return ue(e.data)}}hr.create=s=>new hr({typeName:m.ZodSymbol,...$(s)});class fr extends j{_parse(e){if(this._getType(e)!==v.undefined){const n=this._getOrReturnCtx(e);return b(n,{code:f.invalid_type,expected:v.undefined,received:n.parsedType}),O}return ue(e.data)}}fr.create=s=>new fr({typeName:m.ZodUndefined,...$(s)});class mr extends j{_parse(e){if(this._getType(e)!==v.null){const n=this._getOrReturnCtx(e);return b(n,{code:f.invalid_type,expected:v.null,received:n.parsedType}),O}return ue(e.data)}}mr.create=s=>new mr({typeName:m.ZodNull,...$(s)});class pr extends j{constructor(){super(...arguments),this._any=!0}_parse(e){return ue(e.data)}}pr.create=s=>new pr({typeName:m.ZodAny,...$(s)});class gr extends j{constructor(){super(...arguments),this._unknown=!0}_parse(e){return ue(e.data)}}gr.create=s=>new gr({typeName:m.ZodUnknown,...$(s)});class $e extends j{_parse(e){const t=this._getOrReturnCtx(e);return b(t,{code:f.invalid_type,expected:v.never,received:t.parsedType}),O}}$e.create=s=>new $e({typeName:m.ZodNever,...$(s)});class yr extends j{_parse(e){if(this._getType(e)!==v.undefined){const n=this._getOrReturnCtx(e);return b(n,{code:f.invalid_type,expected:v.void,received:n.parsedType}),O}return ue(e.data)}}yr.create=s=>new yr({typeName:m.ZodVoid,...$(s)});class we extends j{_parse(e){const{ctx:t,status:n}=this._processInputParams(e),r=this._def;if(t.parsedType!==v.array)return b(t,{code:f.invalid_type,expected:v.array,received:t.parsedType}),O;if(r.exactLength!==null){const i=t.data.length>r.exactLength.value,o=t.data.length<r.exactLength.value;(i||o)&&(b(t,{code:i?f.too_big:f.too_small,minimum:o?r.exactLength.value:void 0,maximum:i?r.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:r.exactLength.message}),n.dirty())}if(r.minLength!==null&&t.data.length<r.minLength.value&&(b(t,{code:f.too_small,minimum:r.minLength.value,type:"array",inclusive:!0,exact:!1,message:r.minLength.message}),n.dirty()),r.maxLength!==null&&t.data.length>r.maxLength.value&&(b(t,{code:f.too_big,maximum:r.maxLength.value,type:"array",inclusive:!0,exact:!1,message:r.maxLength.message}),n.dirty()),t.common.async)return Promise.all([...t.data].map((i,o)=>r.type._parseAsync(new Te(t,i,t.path,o)))).then(i=>ce.mergeArray(n,i));const a=[...t.data].map((i,o)=>r.type._parseSync(new Te(t,i,t.path,o)));return ce.mergeArray(n,a)}get element(){return this._def.type}min(e,t){return new we({...this._def,minLength:{value:e,message:k.toString(t)}})}max(e,t){return new we({...this._def,maxLength:{value:e,message:k.toString(t)}})}length(e,t){return new we({...this._def,exactLength:{value:e,message:k.toString(t)}})}nonempty(e){return this.min(1,e)}}we.create=(s,e)=>new we({type:s,minLength:null,maxLength:null,exactLength:null,typeName:m.ZodArray,...$(e)});function Ke(s){if(s instanceof X){const e={};for(const t in s.shape){const n=s.shape[t];e[t]=Oe.create(Ke(n))}return new X({...s._def,shape:()=>e})}else return s instanceof we?new we({...s._def,type:Ke(s.element)}):s instanceof Oe?Oe.create(Ke(s.unwrap())):s instanceof rt?rt.create(Ke(s.unwrap())):s instanceof Ze?Ze.create(s.items.map(e=>Ke(e))):s}class X extends j{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),t=M.objectKeys(e);return this._cached={shape:e,keys:t},this._cached}_parse(e){if(this._getType(e)!==v.object){const l=this._getOrReturnCtx(e);return b(l,{code:f.invalid_type,expected:v.object,received:l.parsedType}),O}const{status:n,ctx:r}=this._processInputParams(e),{shape:a,keys:i}=this._getCached(),o=[];if(!(this._def.catchall instanceof $e&&this._def.unknownKeys==="strip"))for(const l in r.data)i.includes(l)||o.push(l);const c=[];for(const l of i){const u=a[l],h=r.data[l];c.push({key:{status:"valid",value:l},value:u._parse(new Te(r,h,r.path,l)),alwaysSet:l in r.data})}if(this._def.catchall instanceof $e){const l=this._def.unknownKeys;if(l==="passthrough")for(const u of o)c.push({key:{status:"valid",value:u},value:{status:"valid",value:r.data[u]}});else if(l==="strict")o.length>0&&(b(r,{code:f.unrecognized_keys,keys:o}),n.dirty());else if(l!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const l=this._def.catchall;for(const u of o){const h=r.data[u];c.push({key:{status:"valid",value:u},value:l._parse(new Te(r,h,r.path,u)),alwaysSet:u in r.data})}}return r.common.async?Promise.resolve().then(async()=>{const l=[];for(const u of c){const h=await u.key,d=await u.value;l.push({key:h,value:d,alwaysSet:u.alwaysSet})}return l}).then(l=>ce.mergeObjectSync(n,l)):ce.mergeObjectSync(n,c)}get shape(){return this._def.shape()}strict(e){return k.errToObj,new X({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,n)=>{var a,i;const r=((i=(a=this._def).errorMap)==null?void 0:i.call(a,t,n).message)??n.defaultError;return t.code==="unrecognized_keys"?{message:k.errToObj(e).message??r}:{message:r}}}:{}})}strip(){return new X({...this._def,unknownKeys:"strip"})}passthrough(){return new X({...this._def,unknownKeys:"passthrough"})}extend(e){return new X({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new X({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:m.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new X({...this._def,catchall:e})}pick(e){const t={};for(const n of M.objectKeys(e))e[n]&&this.shape[n]&&(t[n]=this.shape[n]);return new X({...this._def,shape:()=>t})}omit(e){const t={};for(const n of M.objectKeys(this.shape))e[n]||(t[n]=this.shape[n]);return new X({...this._def,shape:()=>t})}deepPartial(){return Ke(this)}partial(e){const t={};for(const n of M.objectKeys(this.shape)){const r=this.shape[n];e&&!e[n]?t[n]=r:t[n]=r.optional()}return new X({...this._def,shape:()=>t})}required(e){const t={};for(const n of M.objectKeys(this.shape))if(e&&!e[n])t[n]=this.shape[n];else{let a=this.shape[n];for(;a instanceof Oe;)a=a._def.innerType;t[n]=a}return new X({...this._def,shape:()=>t})}keyof(){return Ja(M.objectKeys(this.shape))}}X.create=(s,e)=>new X({shape:()=>s,unknownKeys:"strip",catchall:$e.create(),typeName:m.ZodObject,...$(e)});X.strictCreate=(s,e)=>new X({shape:()=>s,unknownKeys:"strict",catchall:$e.create(),typeName:m.ZodObject,...$(e)});X.lazycreate=(s,e)=>new X({shape:s,unknownKeys:"strip",catchall:$e.create(),typeName:m.ZodObject,...$(e)});class Yt extends j{_parse(e){const{ctx:t}=this._processInputParams(e),n=this._def.options;function r(a){for(const o of a)if(o.result.status==="valid")return o.result;for(const o of a)if(o.result.status==="dirty")return t.common.issues.push(...o.ctx.common.issues),o.result;const i=a.map(o=>new ke(o.ctx.common.issues));return b(t,{code:f.invalid_union,unionErrors:i}),O}if(t.common.async)return Promise.all(n.map(async a=>{const i={...t,common:{...t.common,issues:[]},parent:null};return{result:await a._parseAsync({data:t.data,path:t.path,parent:i}),ctx:i}})).then(r);{let a;const i=[];for(const c of n){const l={...t,common:{...t.common,issues:[]},parent:null},u=c._parseSync({data:t.data,path:t.path,parent:l});if(u.status==="valid")return u;u.status==="dirty"&&!a&&(a={result:u,ctx:l}),l.common.issues.length&&i.push(l.common.issues)}if(a)return t.common.issues.push(...a.ctx.common.issues),a.result;const o=i.map(c=>new ke(c));return b(t,{code:f.invalid_union,unionErrors:o}),O}}get options(){return this._def.options}}Yt.create=(s,e)=>new Yt({options:s,typeName:m.ZodUnion,...$(e)});function Jn(s,e){const t=Pe(s),n=Pe(e);if(s===e)return{valid:!0,data:s};if(t===v.object&&n===v.object){const r=M.objectKeys(e),a=M.objectKeys(s).filter(o=>r.indexOf(o)!==-1),i={...s,...e};for(const o of a){const c=Jn(s[o],e[o]);if(!c.valid)return{valid:!1};i[o]=c.data}return{valid:!0,data:i}}else if(t===v.array&&n===v.array){if(s.length!==e.length)return{valid:!1};const r=[];for(let a=0;a<s.length;a++){const i=s[a],o=e[a],c=Jn(i,o);if(!c.valid)return{valid:!1};r.push(c.data)}return{valid:!0,data:r}}else return t===v.date&&n===v.date&&+s==+e?{valid:!0,data:s}:{valid:!1}}class Qt extends j{_parse(e){const{status:t,ctx:n}=this._processInputParams(e),r=(a,i)=>{if(cr(a)||cr(i))return O;const o=Jn(a.value,i.value);return o.valid?((lr(a)||lr(i))&&t.dirty(),{status:t.value,value:o.data}):(b(n,{code:f.invalid_intersection_types}),O)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([a,i])=>r(a,i)):r(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}Qt.create=(s,e,t)=>new Qt({left:s,right:e,typeName:m.ZodIntersection,...$(t)});class Ze extends j{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==v.array)return b(n,{code:f.invalid_type,expected:v.array,received:n.parsedType}),O;if(n.data.length<this._def.items.length)return b(n,{code:f.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),O;!this._def.rest&&n.data.length>this._def.items.length&&(b(n,{code:f.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const a=[...n.data].map((i,o)=>{const c=this._def.items[o]||this._def.rest;return c?c._parse(new Te(n,i,n.path,o)):null}).filter(i=>!!i);return n.common.async?Promise.all(a).then(i=>ce.mergeArray(t,i)):ce.mergeArray(t,a)}get items(){return this._def.items}rest(e){return new Ze({...this._def,rest:e})}}Ze.create=(s,e)=>{if(!Array.isArray(s))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Ze({items:s,typeName:m.ZodTuple,rest:null,...$(e)})};class _r extends j{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==v.map)return b(n,{code:f.invalid_type,expected:v.map,received:n.parsedType}),O;const r=this._def.keyType,a=this._def.valueType,i=[...n.data.entries()].map(([o,c],l)=>({key:r._parse(new Te(n,o,n.path,[l,"key"])),value:a._parse(new Te(n,c,n.path,[l,"value"]))}));if(n.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const c of i){const l=await c.key,u=await c.value;if(l.status==="aborted"||u.status==="aborted")return O;(l.status==="dirty"||u.status==="dirty")&&t.dirty(),o.set(l.value,u.value)}return{status:t.value,value:o}})}else{const o=new Map;for(const c of i){const l=c.key,u=c.value;if(l.status==="aborted"||u.status==="aborted")return O;(l.status==="dirty"||u.status==="dirty")&&t.dirty(),o.set(l.value,u.value)}return{status:t.value,value:o}}}}_r.create=(s,e,t)=>new _r({valueType:e,keyType:s,typeName:m.ZodMap,...$(t)});class xt extends j{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==v.set)return b(n,{code:f.invalid_type,expected:v.set,received:n.parsedType}),O;const r=this._def;r.minSize!==null&&n.data.size<r.minSize.value&&(b(n,{code:f.too_small,minimum:r.minSize.value,type:"set",inclusive:!0,exact:!1,message:r.minSize.message}),t.dirty()),r.maxSize!==null&&n.data.size>r.maxSize.value&&(b(n,{code:f.too_big,maximum:r.maxSize.value,type:"set",inclusive:!0,exact:!1,message:r.maxSize.message}),t.dirty());const a=this._def.valueType;function i(c){const l=new Set;for(const u of c){if(u.status==="aborted")return O;u.status==="dirty"&&t.dirty(),l.add(u.value)}return{status:t.value,value:l}}const o=[...n.data.values()].map((c,l)=>a._parse(new Te(n,c,n.path,l)));return n.common.async?Promise.all(o).then(c=>i(c)):i(o)}min(e,t){return new xt({...this._def,minSize:{value:e,message:k.toString(t)}})}max(e,t){return new xt({...this._def,maxSize:{value:e,message:k.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}xt.create=(s,e)=>new xt({valueType:s,minSize:null,maxSize:null,typeName:m.ZodSet,...$(e)});class br extends j{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}br.create=(s,e)=>new br({getter:s,typeName:m.ZodLazy,...$(e)});class wr extends j{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return b(t,{received:t.data,code:f.invalid_literal,expected:this._def.value}),O}return{status:"valid",value:e.data}}get value(){return this._def.value}}wr.create=(s,e)=>new wr({value:s,typeName:m.ZodLiteral,...$(e)});function Ja(s,e){return new nt({values:s,typeName:m.ZodEnum,...$(e)})}class nt extends j{_parse(e){if(typeof e.data!="string"){const t=this._getOrReturnCtx(e),n=this._def.values;return b(t,{expected:M.joinValues(n),received:t.parsedType,code:f.invalid_type}),O}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){const t=this._getOrReturnCtx(e),n=this._def.values;return b(t,{received:t.data,code:f.invalid_enum_value,options:n}),O}return ue(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return nt.create(e,{...this._def,...t})}exclude(e,t=this._def){return nt.create(this.options.filter(n=>!e.includes(n)),{...this._def,...t})}}nt.create=Ja;class xr extends j{_parse(e){const t=M.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==v.string&&n.parsedType!==v.number){const r=M.objectValues(t);return b(n,{expected:M.joinValues(r),received:n.parsedType,code:f.invalid_type}),O}if(this._cache||(this._cache=new Set(M.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const r=M.objectValues(t);return b(n,{received:n.data,code:f.invalid_enum_value,options:r}),O}return ue(e.data)}get enum(){return this._def.values}}xr.create=(s,e)=>new xr({values:s,typeName:m.ZodNativeEnum,...$(e)});class en extends j{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==v.promise&&t.common.async===!1)return b(t,{code:f.invalid_type,expected:v.promise,received:t.parsedType}),O;const n=t.parsedType===v.promise?t.data:Promise.resolve(t.data);return ue(n.then(r=>this._def.type.parseAsync(r,{path:t.path,errorMap:t.common.contextualErrorMap})))}}en.create=(s,e)=>new en({type:s,typeName:m.ZodPromise,...$(e)});class st extends j{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===m.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:n}=this._processInputParams(e),r=this._def.effect||null,a={addIssue:i=>{b(n,i),i.fatal?t.abort():t.dirty()},get path(){return n.path}};if(a.addIssue=a.addIssue.bind(a),r.type==="preprocess"){const i=r.transform(n.data,a);if(n.common.async)return Promise.resolve(i).then(async o=>{if(t.value==="aborted")return O;const c=await this._def.schema._parseAsync({data:o,path:n.path,parent:n});return c.status==="aborted"?O:c.status==="dirty"||t.value==="dirty"?mt(c.value):c});{if(t.value==="aborted")return O;const o=this._def.schema._parseSync({data:i,path:n.path,parent:n});return o.status==="aborted"?O:o.status==="dirty"||t.value==="dirty"?mt(o.value):o}}if(r.type==="refinement"){const i=o=>{const c=r.refinement(o,a);if(n.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(n.common.async===!1){const o=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return o.status==="aborted"?O:(o.status==="dirty"&&t.dirty(),i(o.value),{status:t.value,value:o.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(o=>o.status==="aborted"?O:(o.status==="dirty"&&t.dirty(),i(o.value).then(()=>({status:t.value,value:o.value}))))}if(r.type==="transform")if(n.common.async===!1){const i=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!tt(i))return O;const o=r.transform(i.value,a);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:o}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(i=>tt(i)?Promise.resolve(r.transform(i.value,a)).then(o=>({status:t.value,value:o})):O);M.assertNever(r)}}st.create=(s,e,t)=>new st({schema:s,typeName:m.ZodEffects,effect:e,...$(t)});st.createWithPreprocess=(s,e,t)=>new st({schema:e,effect:{type:"preprocess",transform:s},typeName:m.ZodEffects,...$(t)});class Oe extends j{_parse(e){return this._getType(e)===v.undefined?ue(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Oe.create=(s,e)=>new Oe({innerType:s,typeName:m.ZodOptional,...$(e)});class rt extends j{_parse(e){return this._getType(e)===v.null?ue(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}rt.create=(s,e)=>new rt({innerType:s,typeName:m.ZodNullable,...$(e)});class Hn extends j{_parse(e){const{ctx:t}=this._processInputParams(e);let n=t.data;return t.parsedType===v.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}Hn.create=(s,e)=>new Hn({innerType:s,typeName:m.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...$(e)});class qn extends j{_parse(e){const{ctx:t}=this._processInputParams(e),n={...t,common:{...t.common,issues:[]}},r=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return Kt(r)?r.then(a=>({status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new ke(n.common.issues)},input:n.data})})):{status:"valid",value:r.status==="valid"?r.value:this._def.catchValue({get error(){return new ke(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}qn.create=(s,e)=>new qn({innerType:s,typeName:m.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...$(e)});class vr extends j{_parse(e){if(this._getType(e)!==v.nan){const n=this._getOrReturnCtx(e);return b(n,{code:f.invalid_type,expected:v.nan,received:n.parsedType}),O}return{status:"valid",value:e.data}}}vr.create=s=>new vr({typeName:m.ZodNaN,...$(s)});class Wo extends j{_parse(e){const{ctx:t}=this._processInputParams(e),n=t.data;return this._def.type._parse({data:n,path:t.path,parent:t})}unwrap(){return this._def.type}}class Ns extends j{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.common.async)return(async()=>{const a=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return a.status==="aborted"?O:a.status==="dirty"?(t.dirty(),mt(a.value)):this._def.out._parseAsync({data:a.value,path:n.path,parent:n})})();{const r=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return r.status==="aborted"?O:r.status==="dirty"?(t.dirty(),{status:"dirty",value:r.value}):this._def.out._parseSync({data:r.value,path:n.path,parent:n})}}static create(e,t){return new Ns({in:e,out:t,typeName:m.ZodPipeline})}}class Xn extends j{_parse(e){const t=this._def.innerType._parse(e),n=r=>(tt(r)&&(r.value=Object.freeze(r.value)),r);return Kt(t)?t.then(r=>n(r)):n(t)}unwrap(){return this._def.innerType}}Xn.create=(s,e)=>new Xn({innerType:s,typeName:m.ZodReadonly,...$(e)});var m;(function(s){s.ZodString="ZodString",s.ZodNumber="ZodNumber",s.ZodNaN="ZodNaN",s.ZodBigInt="ZodBigInt",s.ZodBoolean="ZodBoolean",s.ZodDate="ZodDate",s.ZodSymbol="ZodSymbol",s.ZodUndefined="ZodUndefined",s.ZodNull="ZodNull",s.ZodAny="ZodAny",s.ZodUnknown="ZodUnknown",s.ZodNever="ZodNever",s.ZodVoid="ZodVoid",s.ZodArray="ZodArray",s.ZodObject="ZodObject",s.ZodUnion="ZodUnion",s.ZodDiscriminatedUnion="ZodDiscriminatedUnion",s.ZodIntersection="ZodIntersection",s.ZodTuple="ZodTuple",s.ZodRecord="ZodRecord",s.ZodMap="ZodMap",s.ZodSet="ZodSet",s.ZodFunction="ZodFunction",s.ZodLazy="ZodLazy",s.ZodLiteral="ZodLiteral",s.ZodEnum="ZodEnum",s.ZodEffects="ZodEffects",s.ZodNativeEnum="ZodNativeEnum",s.ZodOptional="ZodOptional",s.ZodNullable="ZodNullable",s.ZodDefault="ZodDefault",s.ZodCatch="ZodCatch",s.ZodPromise="ZodPromise",s.ZodBranded="ZodBranded",s.ZodPipeline="ZodPipeline",s.ZodReadonly="ZodReadonly"})(m||(m={}));const Rn=Re.create;$e.create;const zo=we.create,Ha=X.create;Yt.create;Qt.create;Ze.create;nt.create;en.create;Oe.create;rt.create;function Jo(){return{}}function Ho(s,e){var n,r;const t={type:"array"};return((r=(n=s.type)==null?void 0:n._def)==null?void 0:r.typeName)!==m.ZodAny&&(t.items=L(s.type._def,{...e,currentPath:[...e.currentPath,"items"]})),s.minLength&&B(t,"minItems",s.minLength.value,s.minLength.message,e),s.maxLength&&B(t,"maxItems",s.maxLength.value,s.maxLength.message,e),s.exactLength&&(B(t,"minItems",s.exactLength.value,s.exactLength.message,e),B(t,"maxItems",s.exactLength.value,s.exactLength.message,e)),t}function qo(s,e){const t={type:"integer",format:"int64"};if(!s.checks)return t;for(const n of s.checks)switch(n.kind){case"min":e.target==="jsonSchema7"?n.inclusive?B(t,"minimum",n.value,n.message,e):B(t,"exclusiveMinimum",n.value,n.message,e):(n.inclusive||(t.exclusiveMinimum=!0),B(t,"minimum",n.value,n.message,e));break;case"max":e.target==="jsonSchema7"?n.inclusive?B(t,"maximum",n.value,n.message,e):B(t,"exclusiveMaximum",n.value,n.message,e):(n.inclusive||(t.exclusiveMaximum=!0),B(t,"maximum",n.value,n.message,e));break;case"multipleOf":B(t,"multipleOf",n.value,n.message,e);break}return t}function Xo(){return{type:"boolean"}}function Ko(s,e){return L(s.type._def,e)}const Go=(s,e)=>L(s.innerType._def,e);function qa(s,e,t){const n=t??e.dateStrategy;if(Array.isArray(n))return{anyOf:n.map((r,a)=>qa(s,e,r))};switch(n){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return Yo(s,e)}}const Yo=(s,e)=>{const t={type:"integer",format:"unix-time"};if(e.target==="openApi3")return t;for(const n of s.checks)switch(n.kind){case"min":B(t,"minimum",n.value,n.message,e);break;case"max":B(t,"maximum",n.value,n.message,e);break}return t};function Qo(s,e){return{...L(s.innerType._def,e),default:s.defaultValue()}}function ec(s,e,t){return e.effectStrategy==="input"?L(s.schema._def,e,t):{}}function tc(s){return{type:"string",enum:[...s.values]}}const nc=s=>"type"in s&&s.type==="string"?!1:"allOf"in s;function sc(s,e){const t=[L(s.left._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),L(s.right._def,{...e,currentPath:[...e.currentPath,"allOf","1"]})].filter(a=>!!a);let n=e.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const r=[];return t.forEach(a=>{if(nc(a))r.push(...a.allOf),a.unevaluatedProperties===void 0&&(n=void 0);else{let i=a;if("additionalProperties"in a&&a.additionalProperties===!1){const{additionalProperties:o,...c}=a;i=c}else n=void 0;r.push(i)}}),r.length?{allOf:r,...n}:void 0}function rc(s,e){const t=typeof s.value;return t!=="bigint"&&t!=="number"&&t!=="boolean"&&t!=="string"?{type:Array.isArray(s.value)?"array":"object"}:e.target==="openApi3"?{type:t==="bigint"?"integer":t,enum:[s.value]}:{type:t==="bigint"?"integer":t,const:s.value}}let En;const Me={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(En===void 0&&(En=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),En),base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/};function Xa(s,e){const t={type:"string"};function n(r){return e.patternStrategy==="escape"?ac(r):r}if(s.checks)for(const r of s.checks)switch(r.kind){case"min":B(t,"minLength",typeof t.minLength=="number"?Math.max(t.minLength,r.value):r.value,r.message,e);break;case"max":B(t,"maxLength",typeof t.maxLength=="number"?Math.min(t.maxLength,r.value):r.value,r.message,e);break;case"email":switch(e.emailStrategy){case"format:email":de(t,"email",r.message,e);break;case"format:idn-email":de(t,"idn-email",r.message,e);break;case"pattern:zod":he(t,Me.email,r.message,e);break}break;case"url":de(t,"uri",r.message,e);break;case"uuid":de(t,"uuid",r.message,e);break;case"regex":he(t,r.regex,r.message,e);break;case"cuid":he(t,Me.cuid,r.message,e);break;case"cuid2":he(t,Me.cuid2,r.message,e);break;case"startsWith":he(t,RegExp(`^${n(r.value)}`),r.message,e);break;case"endsWith":he(t,RegExp(`${n(r.value)}$`),r.message,e);break;case"datetime":de(t,"date-time",r.message,e);break;case"date":de(t,"date",r.message,e);break;case"time":de(t,"time",r.message,e);break;case"duration":de(t,"duration",r.message,e);break;case"length":B(t,"minLength",typeof t.minLength=="number"?Math.max(t.minLength,r.value):r.value,r.message,e),B(t,"maxLength",typeof t.maxLength=="number"?Math.min(t.maxLength,r.value):r.value,r.message,e);break;case"includes":{he(t,RegExp(n(r.value)),r.message,e);break}case"ip":{r.version!=="v6"&&de(t,"ipv4",r.message,e),r.version!=="v4"&&de(t,"ipv6",r.message,e);break}case"emoji":he(t,Me.emoji,r.message,e);break;case"ulid":{he(t,Me.ulid,r.message,e);break}case"base64":{switch(e.base64Strategy){case"format:binary":{de(t,"binary",r.message,e);break}case"contentEncoding:base64":{B(t,"contentEncoding","base64",r.message,e);break}case"pattern:zod":{he(t,Me.base64,r.message,e);break}}break}case"nanoid":he(t,Me.nanoid,r.message,e)}return t}const ac=s=>Array.from(s).map(e=>/[a-zA-Z0-9]/.test(e)?e:`\\${e}`).join(""),de=(s,e,t,n)=>{var r;s.format||(r=s.anyOf)!=null&&r.some(a=>a.format)?(s.anyOf||(s.anyOf=[]),s.format&&(s.anyOf.push({format:s.format,...s.errorMessage&&n.errorMessages&&{errorMessage:{format:s.errorMessage.format}}}),delete s.format,s.errorMessage&&(delete s.errorMessage.format,Object.keys(s.errorMessage).length===0&&delete s.errorMessage)),s.anyOf.push({format:e,...t&&n.errorMessages&&{errorMessage:{format:t}}})):B(s,"format",e,t,n)},he=(s,e,t,n)=>{var r;s.pattern||(r=s.allOf)!=null&&r.some(a=>a.pattern)?(s.allOf||(s.allOf=[]),s.pattern&&(s.allOf.push({pattern:s.pattern,...s.errorMessage&&n.errorMessages&&{errorMessage:{pattern:s.errorMessage.pattern}}}),delete s.pattern,s.errorMessage&&(delete s.errorMessage.pattern,Object.keys(s.errorMessage).length===0&&delete s.errorMessage)),s.allOf.push({pattern:kr(e,n),...t&&n.errorMessages&&{errorMessage:{pattern:t}}})):B(s,"pattern",kr(e,n),t,n)},kr=(s,e)=>{var l;const t=typeof s=="function"?s():s;if(!e.applyRegexFlags||!t.flags)return t.source;const n={i:t.flags.includes("i"),m:t.flags.includes("m"),s:t.flags.includes("s")},r=n.i?t.source.toLowerCase():t.source;let a="",i=!1,o=!1,c=!1;for(let u=0;u<r.length;u++){if(i){a+=r[u],i=!1;continue}if(n.i){if(o){if(r[u].match(/[a-z]/)){c?(a+=r[u],a+=`${r[u-2]}-${r[u]}`.toUpperCase(),c=!1):r[u+1]==="-"&&((l=r[u+2])!=null&&l.match(/[a-z]/))?(a+=r[u],c=!0):a+=`${r[u]}${r[u].toUpperCase()}`;continue}}else if(r[u].match(/[a-z]/)){a+=`[${r[u]}${r[u].toUpperCase()}]`;continue}}if(n.m){if(r[u]==="^"){a+=`(^|(?<=[\r
]))`;continue}else if(r[u]==="$"){a+=`($|(?=[\r
]))`;continue}}if(n.s&&r[u]==="."){a+=o?`${r[u]}\r
`:`[${r[u]}\r
]`;continue}a+=r[u],r[u]==="\\"?i=!0:o&&r[u]==="]"?o=!1:!o&&r[u]==="["&&(o=!0)}try{const u=new RegExp(a)}catch{return console.warn(`Could not convert regex pattern at ${e.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),t.source}return a};function Ka(s,e){var n,r,a,i;if(e.target==="openApi3"&&((n=s.keyType)==null?void 0:n._def.typeName)===m.ZodEnum)return{type:"object",required:s.keyType._def.values,properties:s.keyType._def.values.reduce((o,c)=>({...o,[c]:L(s.valueType._def,{...e,currentPath:[...e.currentPath,"properties",c]})??{}}),{}),additionalProperties:!1};const t={type:"object",additionalProperties:L(s.valueType._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??{}};if(e.target==="openApi3")return t;if(((r=s.keyType)==null?void 0:r._def.typeName)===m.ZodString&&((a=s.keyType._def.checks)!=null&&a.length)){const o=Object.entries(Xa(s.keyType._def,e)).reduce((c,[l,u])=>l==="type"?c:{...c,[l]:u},{});return{...t,propertyNames:o}}else if(((i=s.keyType)==null?void 0:i._def.typeName)===m.ZodEnum)return{...t,propertyNames:{enum:s.keyType._def.values}};return t}function ic(s,e){if(e.mapStrategy==="record")return Ka(s,e);const t=L(s.keyType._def,{...e,currentPath:[...e.currentPath,"items","items","0"]})||{},n=L(s.valueType._def,{...e,currentPath:[...e.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[t,n],minItems:2,maxItems:2}}}function oc(s){const e=s.values,n=Object.keys(s.values).filter(a=>typeof e[e[a]]!="number").map(a=>e[a]),r=Array.from(new Set(n.map(a=>typeof a)));return{type:r.length===1?r[0]==="string"?"string":"number":["string","number"],enum:n}}function cc(){return{not:{}}}function lc(s){return s.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const tn={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function uc(s,e){if(e.target==="openApi3")return Sr(s,e);const t=s.options instanceof Map?Array.from(s.options.values()):s.options;if(t.every(n=>n._def.typeName in tn&&(!n._def.checks||!n._def.checks.length))){const n=t.reduce((r,a)=>{const i=tn[a._def.typeName];return i&&!r.includes(i)?[...r,i]:r},[]);return{type:n.length>1?n:n[0]}}else if(t.every(n=>n._def.typeName==="ZodLiteral"&&!n.description)){const n=t.reduce((r,a)=>{const i=typeof a._def.value;switch(i){case"string":case"number":case"boolean":return[...r,i];case"bigint":return[...r,"integer"];case"object":if(a._def.value===null)return[...r,"null"];case"symbol":case"undefined":case"function":default:return r}},[]);if(n.length===t.length){const r=n.filter((a,i,o)=>o.indexOf(a)===i);return{type:r.length>1?r:r[0],enum:t.reduce((a,i)=>a.includes(i._def.value)?a:[...a,i._def.value],[])}}}else if(t.every(n=>n._def.typeName==="ZodEnum"))return{type:"string",enum:t.reduce((n,r)=>[...n,...r._def.values.filter(a=>!n.includes(a))],[])};return Sr(s,e)}const Sr=(s,e)=>{const t=(s.options instanceof Map?Array.from(s.options.values()):s.options).map((n,r)=>L(n._def,{...e,currentPath:[...e.currentPath,"anyOf",`${r}`]})).filter(n=>!!n&&(!e.strictUnions||typeof n=="object"&&Object.keys(n).length>0));return t.length?{anyOf:t}:void 0};function dc(s,e){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(s.innerType._def.typeName)&&(!s.innerType._def.checks||!s.innerType._def.checks.length))return e.target==="openApi3"||e.nullableStrategy==="property"?{type:tn[s.innerType._def.typeName],nullable:!0}:{type:[tn[s.innerType._def.typeName],"null"]};if(e.target==="openApi3"){const n=L(s.innerType._def,{...e,currentPath:[...e.currentPath]});return n&&"$ref"in n?{allOf:[n],nullable:!0}:n&&{...n,nullable:!0}}const t=L(s.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","0"]});return t&&{anyOf:[t,{type:"null"}]}}function hc(s,e){const t={type:"number"};if(!s.checks)return t;for(const n of s.checks)switch(n.kind){case"int":t.type="integer",Va(t,"type",n.message,e);break;case"min":e.target==="jsonSchema7"?n.inclusive?B(t,"minimum",n.value,n.message,e):B(t,"exclusiveMinimum",n.value,n.message,e):(n.inclusive||(t.exclusiveMinimum=!0),B(t,"minimum",n.value,n.message,e));break;case"max":e.target==="jsonSchema7"?n.inclusive?B(t,"maximum",n.value,n.message,e):B(t,"exclusiveMaximum",n.value,n.message,e):(n.inclusive||(t.exclusiveMaximum=!0),B(t,"maximum",n.value,n.message,e));break;case"multipleOf":B(t,"multipleOf",n.value,n.message,e);break}return t}function fc(s,e){return e.removeAdditionalStrategy==="strict"?s.catchall._def.typeName==="ZodNever"?s.unknownKeys!=="strict":L(s.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??!0:s.catchall._def.typeName==="ZodNever"?s.unknownKeys==="passthrough":L(s.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??!0}function mc(s,e){const t={type:"object",...Object.entries(s.shape()).reduce((n,[r,a])=>{if(a===void 0||a._def===void 0)return n;const i=[...e.currentPath,"properties",r],o=L(a._def,{...e,currentPath:i,propertyPath:i});return o===void 0?n:(e.openaiStrictMode&&a.isOptional()&&!a.isNullable()&&console.warn(`Zod field at \`${i.join("/")}\` uses \`.optional()\` without \`.nullable()\` which is not supported by the API. See: https://platform.openai.com/docs/guides/structured-outputs?api-mode=responses#all-fields-must-be-required
This will become an error in a future version of the SDK.`),{properties:{...n.properties,[r]:o},required:a.isOptional()&&!e.openaiStrictMode?n.required:[...n.required,r]})},{properties:{},required:[]}),additionalProperties:fc(s,e)};return t.required.length||delete t.required,t}const pc=(s,e)=>{var n;if(e.currentPath.toString()===((n=e.propertyPath)==null?void 0:n.toString()))return L(s.innerType._def,e);const t=L(s.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","1"]});return t?{anyOf:[{not:{}},t]}:{}},gc=(s,e)=>{if(e.pipeStrategy==="input")return L(s.in._def,e);if(e.pipeStrategy==="output")return L(s.out._def,e);const t=L(s.in._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),n=L(s.out._def,{...e,currentPath:[...e.currentPath,"allOf",t?"1":"0"]});return{allOf:[t,n].filter(r=>r!==void 0)}};function yc(s,e){return L(s.type._def,e)}function _c(s,e){const n={type:"array",uniqueItems:!0,items:L(s.valueType._def,{...e,currentPath:[...e.currentPath,"items"]})};return s.minSize&&B(n,"minItems",s.minSize.value,s.minSize.message,e),s.maxSize&&B(n,"maxItems",s.maxSize.value,s.maxSize.message,e),n}function bc(s,e){return s.rest?{type:"array",minItems:s.items.length,items:s.items.map((t,n)=>L(t._def,{...e,currentPath:[...e.currentPath,"items",`${n}`]})).reduce((t,n)=>n===void 0?t:[...t,n],[]),additionalItems:L(s.rest._def,{...e,currentPath:[...e.currentPath,"additionalItems"]})}:{type:"array",minItems:s.items.length,maxItems:s.items.length,items:s.items.map((t,n)=>L(t._def,{...e,currentPath:[...e.currentPath,"items",`${n}`]})).reduce((t,n)=>n===void 0?t:[...t,n],[])}}function wc(){return{not:{}}}function xc(){return{}}const vc=(s,e)=>L(s.innerType._def,e);function L(s,e,t=!1){var i;const n=e.seen.get(s);if(e.override){const o=(i=e.override)==null?void 0:i.call(e,s,e,n,t);if(o!==po)return o}if(n&&!t){const o=kc(n,e);if(o!==void 0)return"$ref"in o&&e.seenRefs.add(o.$ref),o}const r={def:s,path:e.currentPath,jsonSchema:void 0};e.seen.set(s,r);const a=Ac(s,s.typeName,e,t);return a&&Cc(s,e,a),r.jsonSchema=a,a}const kc=(s,e)=>{switch(e.$refStrategy){case"root":return{$ref:s.path.join("/")};case"extract-to-root":const t=s.path.slice(e.basePath.length+1).join("_");return t!==e.name&&e.nameStrategy==="duplicate-ref"&&(e.definitions[t]=s.def),{$ref:[...e.basePath,e.definitionPath,t].join("/")};case"relative":return{$ref:Sc(e.currentPath,s.path)};case"none":case"seen":return s.path.length<e.currentPath.length&&s.path.every((n,r)=>e.currentPath[r]===n)?(console.warn(`Recursive reference detected at ${e.currentPath.join("/")}! Defaulting to any`),{}):e.$refStrategy==="seen"?{}:void 0}},Sc=(s,e)=>{let t=0;for(;t<s.length&&t<e.length&&s[t]===e[t];t++);return[(s.length-t).toString(),...e.slice(t)].join("/")},Ac=(s,e,t,n)=>{switch(e){case m.ZodString:return Xa(s,t);case m.ZodNumber:return hc(s,t);case m.ZodObject:return mc(s,t);case m.ZodBigInt:return qo(s,t);case m.ZodBoolean:return Xo();case m.ZodDate:return qa(s,t);case m.ZodUndefined:return wc();case m.ZodNull:return lc(t);case m.ZodArray:return Ho(s,t);case m.ZodUnion:case m.ZodDiscriminatedUnion:return uc(s,t);case m.ZodIntersection:return sc(s,t);case m.ZodTuple:return bc(s,t);case m.ZodRecord:return Ka(s,t);case m.ZodLiteral:return rc(s,t);case m.ZodEnum:return tc(s);case m.ZodNativeEnum:return oc(s);case m.ZodNullable:return dc(s,t);case m.ZodOptional:return pc(s,t);case m.ZodMap:return ic(s,t);case m.ZodSet:return _c(s,t);case m.ZodLazy:return L(s.getter()._def,t);case m.ZodPromise:return yc(s,t);case m.ZodNaN:case m.ZodNever:return cc();case m.ZodEffects:return ec(s,t,n);case m.ZodAny:return Jo();case m.ZodUnknown:return xc();case m.ZodDefault:return Qo(s,t);case m.ZodBranded:return Ko(s,t);case m.ZodReadonly:return vc(s,t);case m.ZodCatch:return Go(s,t);case m.ZodPipeline:return gc(s,t);case m.ZodFunction:case m.ZodVoid:case m.ZodSymbol:return;default:return(r=>{})()}},Cc=(s,e,t)=>(s.description&&(t.description=s.description,e.markdownDescription&&(t.markdownDescription=s.description)),t),Pc=(s,e)=>{const t=_o(e),n=typeof e=="string"?e:(e==null?void 0:e.nameStrategy)==="title"||e==null?void 0:e.name,r=L(s._def,n===void 0?t:{...t,currentPath:[...t.basePath,t.definitionPath,n]},!1)??{},a=typeof e=="object"&&e.name!==void 0&&e.nameStrategy==="title"?e.name:void 0;a!==void 0&&(r.title=a);const i=(()=>{if(yo(t.definitions))return;const c={},l=new Set;for(let u=0;u<500;u++){const h=Object.entries(t.definitions).filter(([d])=>!l.has(d));if(h.length===0)break;for(const[d,y]of h)c[d]=L(Wn(y),{...t,currentPath:[...t.basePath,t.definitionPath,d]},!0)??{},l.add(d)}return c})(),o=n===void 0?i?{...r,[t.definitionPath]:i}:r:t.nameStrategy==="duplicate-ref"?{...r,...i||t.seenRefs.size?{[t.definitionPath]:{...i,...t.seenRefs.size?{[n]:r}:void 0}}:void 0}:{$ref:[...t.$refStrategy==="relative"?[]:t.basePath,t.definitionPath,n].join("/"),[t.definitionPath]:{...i,[n]:r}};return t.target==="jsonSchema7"?o.$schema="http://json-schema.org/draft-07/schema#":t.target==="jsonSchema2019-09"&&(o.$schema="https://json-schema.org/draft/2019-09/schema#"),o};function Rc(s,e){return Pc(s,{openaiStrictMode:!0,name:e.name,nameStrategy:"duplicate-ref",$refStrategy:"extract-to-root",nullableStrategy:"property"})}function Ga(s,e,t){return zi({type:"json_schema",...t,name:e,strict:!0,schema:Rc(s,{name:e})},n=>s.parse(JSON.parse(n)))}const Dt={},Ec="https://head-checker.louispaulet13.workers.dev/?url=";function Ya({recommendations:s,prompt:e}){const t=D.useMemo(()=>{const d=[],y=new Set;for(const _ of s)y.has(_.channel_url)||(d.push(_),y.add(_.channel_url));return d},[s]),[n,r]=D.useState({}),[a,i]=D.useState(!1);D.useEffect(()=>{async function d(_){const w=Ec+_;try{return(await(await fetch(w,{method:"GET"})).json()).status}catch(x){return console.error("Error fetching URL status:",x),null}}async function y(){const _={},w=[];if(t.forEach(g=>{Dt[g.channel_url]!==void 0?_[g.channel_url]=Dt[g.channel_url]:w.push(g.channel_url)}),Object.keys(_).length>0&&r(g=>({...g,..._})),w.length===0)return;const x=w.map(async g=>{try{const A=await d(g);return Dt[g]=A,{url:g,status:A}}catch(A){return console.error("Error checking status for",g,A),Dt[g]=null,{url:g,status:null}}}),V=await Promise.all(x);r(g=>{const A={...g};return V.forEach(({url:C,status:F})=>{A[C]=F}),A})}y()},[t]);function o(d){return d===200?{liClass:"p-3 border border-green-600 rounded bg-green-100 text-green-800 flex items-center justify-between",icon:p.jsxs("div",{className:"tooltip","data-tooltip":"Verified Link (HTTP 200)",children:[p.jsx("svg",{className:"w-5 h-5 text-green-700",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24","aria-hidden":"true",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})}),p.jsx("span",{className:"sr-only",children:"Verified Link (HTTP 200)"})]})}:d===404?{liClass:"p-3 border border-gray-500 rounded bg-gray-200 text-gray-800 flex items-center justify-between",icon:p.jsxs("div",{className:"tooltip","data-tooltip":"Incorrect Link (HTTP 404)",children:[p.jsx("svg",{className:"w-5 h-5 text-red-600",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24","aria-hidden":"true",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})}),p.jsx("span",{className:"sr-only",children:"Incorrect Link (HTTP 404)"})]})}:d?{liClass:"p-3 border border-yellow-400 rounded bg-yellow-50 text-yellow-800 flex items-center justify-between",icon:p.jsxs("div",{className:"tooltip","data-tooltip":`Link Status: HTTP ${d}`,children:[p.jsx("svg",{className:"w-5 h-5 text-yellow-600",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24","aria-hidden":"true",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),p.jsx("span",{className:"sr-only",children:`Link Status: HTTP ${d}`})]})}:{liClass:"p-3 border border-gray-300 rounded bg-gray-50 flex items-center justify-between",icon:null}}function c(d){if(!e)return!1;const y=x=>x.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),_=new RegExp(`\\b${y(d.channel_name)}\\b`,"i"),w=new RegExp(y(d.channel_url),"i");return _.test(e)||w.test(e)}function l(){return p.jsx("span",{className:"text-green-700 ml-2",title:"Duplicate","aria-hidden":"true",children:"â™»"})}const u=[...t].sort((d,y)=>{const _=n[d.channel_url],w=n[y.channel_url],x=c(d),V=c(y);function g(F,N){return F===200?1:F===404?2:N?3:4}const A=g(_,x),C=g(w,V);return A!==C?A-C:0}),h=a?u:u.filter(d=>!c(d));return p.jsxs("div",{className:"bg-white font-secondary",children:[p.jsxs("label",{className:"my-4 flex items-center cursor-pointer select-none",children:[p.jsx("span",{className:"mr-3 text-gray-800 font-semibold font-secondary",children:"Show Duplicates"}),p.jsx("input",{type:"checkbox",checked:a,onChange:()=>i(!a),className:"sr-only","aria-label":"Toggle display of duplicate recommendations"}),p.jsx("div",{className:`w-12 h-6 rounded-full transition-colors duration-300 ease-in-out ${a?"bg-primary-600":"bg-gray-300"}`,children:p.jsx("div",{className:`bg-white w-6 h-6 rounded-full shadow-md transform transition-transform duration-300 ease-in-out ${a?"translate-x-6":"translate-x-0"}`})})]}),p.jsx("ul",{className:"mt-6 space-y-3 relative",children:h.map((d,y)=>{const _=n[d.channel_url],{liClass:w,icon:x}=o(_),V=c(d);let g="";return _===200?g="Verified Link (HTTP 200)":_===404?g="Incorrect Link (HTTP 404)":_&&(g=`Link Status: HTTP ${_}`),p.jsxs("li",{className:`${w} rounded-lg shadow-sm hover:shadow-md transition-shadow duration-300 p-3 cursor-pointer flex flex-col md:flex-row md:items-center md:justify-between`,role:"link",tabIndex:0,onClick:()=>window.open(d.channel_url,"_blank","noopener,noreferrer"),onKeyDown:A=>{(A.key==="Enter"||A.key===" ")&&(A.preventDefault(),window.open(d.channel_url,"_blank","noopener,noreferrer"))},children:[p.jsx("span",{className:"text-primary-700 font-semibold mb-2 md:mb-0",style:{minWidth:"10rem"},children:d.channel_name}),p.jsx("p",{className:"text-gray-700 text-sm italic mb-2 md:mb-0 md:flex-grow md:text-center",children:d.recommendation_reason}),p.jsxs("div",{className:"flex items-center space-x-2 flex-shrink-0",children:[x&&p.jsxs("div",{className:"group relative cursor-pointer focus:outline-none",tabIndex:0,"aria-label":g,children:[x,p.jsxs("div",{className:"absolute z-10 invisible opacity-0 group-hover:visible group-hover:opacity-100 group-focus-visible:visible group-focus-visible:opacity-100 inline-block px-4 py-2 text-sm font-medium text-white transition-opacity duration-300 bg-gray-900 rounded-lg shadow-xs tooltip dark:bg-gray-700 whitespace-nowrap max-w-[20rem] overflow-hidden text-ellipsis",style:{bottom:"125%",left:"50%",transform:"translateX(-50%)"},children:[g,p.jsx("div",{className:"tooltip-arrow","data-popper-arrow":!0})]})]}),V&&p.jsxs("div",{className:"group relative cursor-pointer focus:outline-none",tabIndex:0,"aria-label":"Duplicate",children:[l(),p.jsxs("div",{className:"absolute z-10 invisible opacity-0 group-hover:visible group-hover:opacity-100 group-focus-visible:visible group-focus-visible:opacity-100 inline-block px-4 py-2 text-sm font-medium text-white transition-opacity duration-300 bg-gray-900 rounded-lg shadow-xs tooltip dark:bg-gray-700 whitespace-nowrap max-w-[20rem] overflow-hidden text-ellipsis",style:{bottom:"125%",left:"50%",transform:"translateX(-50%)"},children:["Duplicate",p.jsx("div",{className:"tooltip-arrow","data-popper-arrow":!0})]})]})]})]},y)})})]})}const Oc=Ha({channel_name:Rn(),channel_url:Rn(),recommendation_reason:Rn()}),Qa=Ha({recommendations:zo(Oc)});function ei(){return Xe.get("openai_api_key")}const Tc=["Summoning AI","Feeding hamsters","Consulting oracles","Tickling electrons","Shaking dice","Polishing pixels","Untangling wires","Charging creativity crystals","Calibrating sarcasm detector","Counting penguins","Rebooting flux capacitor","Tuning algorithms","Petting server hamsters","Firing up puns","Rearranging playlists","Herding rubber ducks","Recycling jokes"];function $c(s){for(let e=s.length-1;e>0;e--){const t=Math.floor(Math.random()*(e+1));[s[e],s[t]]=[s[t],s[e]]}return s}function ti(s,e,t=Tc,n=2e3){const[r,a]=D.useState(e),i=D.useRef(0),o=D.useRef(t);return D.useEffect(()=>{if(s){o.current=$c([...t]),i.current=0,a(o.current[i.current]);const c=setInterval(()=>{i.current=(i.current+1)%o.current.length,a(o.current[i.current])},n);return()=>clearInterval(c)}i.current=0,a(e)},[s,e,t,n]),r}function Ic({subscriptions:s,recommendations:e}){const[t,n]=D.useState([]),[r,a]=D.useState(!1),[i,o]=D.useState(null),c=ti(r,"Get Improved Recommendations"),[l,u]=Ms.useState("");Ms.useEffect(()=>{const d=ei();d&&u(d)},[]);const h=async()=>{a(!0),o(null);try{const d=new E({apiKey:l,dangerouslyAllowBrowser:!0}),y=`You are a YouTube channel recommender assistant. Given the user's current subscriptions:
${s.join(", ")}

And the previous recommendations:
${e.map(x=>x.channel_name).join(", ")}

Please provide a new list of ${e.length} YouTube channel recommendations that are better than the previous list. Each recommendation should include the channel_name, channel_url, and a brief recommendation_reason. Respond ONLY in JSON format as an array of objects.`,w=(await d.responses.parse({model:"gpt-4.1-nano",input:[{role:"system",content:"You are a helpful assistant that recommends YouTube channels."},{role:"user",content:y}],text:{format:Ga(Qa,"recommendations")}})).output_parsed.recommendations||[];n(w)}catch(d){d&&/Network|Failed to fetch/i.test(d.message)?o("Network error while fetching improved recommendations. Please try again."):o("Error fetching improved recommendations: "+d.message)}finally{a(!1)}};return p.jsxs("div",{className:"mt-8 p-6 bg-gray-50 rounded-lg shadow-md font-secondary",children:[p.jsx("h2",{className:"text-2xl font-semibold mb-4 font-primary",children:"Criticizer: GetÂ Better Recommendations"}),p.jsx("button",{onClick:h,disabled:r,className:"mb-4 w-full py-3 bg-primary-600 hover:bg-primary-700 focus:ring-4 focus:ring-primary-300 text-white font-semibold rounded-lg disabled:opacity-50 disabled:cursor-not-allowed transition flex items-center justify-center",children:r?p.jsxs(p.Fragment,{children:[p.jsx(Kn,{}),c]}):c}),i&&p.jsx("p",{className:"text-red-600 mb-4",children:i}),t.length>0&&p.jsx(Ya,{recommendations:t,prompt:`User subscriptions: ${s.join(", ")}. Previous recommendations: ${e.map(d=>d.channel_name).join(", ")}`})]})}function Ar(s,e=500){const[t,n]=D.useState(s);return D.useEffect(()=>{const r=setTimeout(()=>n(s),e);return()=>clearTimeout(r)},[s,e]),t}function Nc(s){return s.split(/[\n,;]+/).map(e=>e.trim()).filter(e=>e.length>0)}function jc(s){const t=new DOMParser().parseFromString(s,"text/html");return Array.from(t.querySelectorAll("ytd-channel-renderer")).map(r=>{const a=r.querySelector('a.channel-link[href*="/@"]');if(a){const i=a.getAttribute("href").trim();return i.startsWith("http")?i:`https://www.youtube.com${i}`}return null}).filter(Boolean)}function Mc(){const[s,e]=D.useState(""),t=Ar(s,500),[n,r]=D.useState(null),[a,i]=D.useState(!1),[o,c]=D.useState(10),[l,u]=D.useState(""),[h,d]=D.useState(""),y=Ar(h,500),[_,w]=D.useState(!1),[x,V]=D.useState(!1),[g,A]=D.useState(!1),[C,F]=D.useState(""),[N,T]=D.useState(""),se=ti(a,"Get Recommendations"),H=I=>{w(I),I||(e(""),V(!1),F(""),T(""))},W=I=>{if(!I.type.includes("html")){F("Please upload a valid HTML file.");return}F("");const q=new FileReader;q.onload=Be=>{const Ue=Be.target.result,gn=jc(Ue);gn.length===0&&F("No channels found. Did you save the correct page?"),e(gn.join(`
`))},q.onerror=()=>F("Failed to read file."),q.readAsText(I)},Z=async()=>{const I=ei();if(!I){r("API key not found. Please set your OpenAI API key in the homepage."),T("");return}if(_&&!s.trim()){T("Please upload or paste your subscriptions or disable the checkbox."),r(null);return}if(o<1){T("Number of recommendations must be at least 1."),r(null);return}T(""),i(!0),r(null);try{const q=new E({apiKey:I,dangerouslyAllowBrowser:!0}),Be=y.trim()?`Consider these preferred topics or keywords when making recommendations: ${y}.`:"",Ue=_&&t.trim()?`The input list of subscribed channels:

${t}

Do NOT recommend a channel that is already present in the input list.`:"",js=[`Please suggest ${o} new YouTube channels to watch.`,Be,Ue].filter(si=>si).join(`
`);u(js);const ni=(await q.responses.parse({model:"gpt-4.1-nano",input:[{role:"system",content:"You are a helpful assistant that recommends YouTube channels."},{role:"user",content:js}],text:{format:Ga(Qa,"recommendations")}})).output_parsed.recommendations;r(ni)}catch(q){console.error("Error fetching recommendations:",q),q&&/Network|Failed to fetch/i.test(q.message)?T("Network error while fetching recommendations. Please try again."):T(`Failed to get recommendations: ${q.message}`)}finally{i(!1)}};return p.jsxs("section",{className:"max-w-3xl mx-auto p-8 mt-10 bg-white rounded-lg shadow-lg font-secondary",children:[p.jsx("h2",{className:"text-3xl font-extrabold mb-6 text-gray-900 font-primary",children:"YouTube Channel Recommender"}),p.jsxs("label",{className:"block mb-4 text-gray-700 font-medium",children:[p.jsx("input",{type:"checkbox",checked:_,onChange:I=>H(I.target.checked),className:"mr-2"}),"Use my subscription list"]}),_&&p.jsxs("div",{className:"mb-6 space-y-4",children:[p.jsx("button",{type:"button",onClick:()=>V(I=>!I),className:"text-primary-700 underline",children:x?"Hide subscription importer":"Upload subscriptions HTML file"}),x&&p.jsx("div",{onDragOver:I=>{I.preventDefault(),A(!0)},onDragLeave:I=>{I.preventDefault(),A(!1)},onDrop:I=>{I.preventDefault(),A(!1);const q=I.dataTransfer.files&&I.dataTransfer.files[0];q&&W(q)},className:`p-4 border-2 border-dashed rounded-lg ${g?"bg-primary-50 border-primary-600":"border-gray-300"}`,children:p.jsx("input",{type:"file",accept:"text/html",onChange:I=>{const q=I.target.files&&I.target.files[0];q&&W(q)},className:"w-full"})}),C&&p.jsx("p",{className:"text-sm text-red-600",children:C}),p.jsx("textarea",{rows:5,placeholder:"Your subscriptions will appear here",value:s,onChange:I=>e(I.target.value),className:"w-full p-3 border border-gray-300 rounded-lg resize-none focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition"})]}),p.jsxs("label",{className:"block mb-4 text-gray-700 font-medium",children:["Number of recommendations to make:",p.jsx("input",{type:"number",min:"1",value:o,onChange:I=>c(Number(I.target.value)),className:"ml-3 p-2 border border-gray-300 rounded w-20 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition"})]}),p.jsxs("label",{className:"block mb-4 text-gray-700 font-medium",children:["Preferred topics or keywords:",p.jsx("input",{type:"text",placeholder:"e.g. technology, cooking",value:h,onChange:I=>d(I.target.value),className:"mt-1 p-2 border border-gray-300 rounded w-full focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition"})]}),p.jsx("button",{onClick:Z,disabled:a,className:"w-full py-3 bg-primary-600 hover:bg-primary-700 focus:ring-4 focus:ring-primary-300 text-white font-semibold rounded-lg disabled:opacity-50 disabled:cursor-not-allowed transition flex items-center justify-center",children:a?p.jsxs(p.Fragment,{children:[p.jsx(Kn,{}),se]}):se}),N&&p.jsx("p",{className:"mt-4 text-sm text-red-600",role:"alert",children:N}),n&&(Array.isArray(n)?p.jsxs(p.Fragment,{children:[p.jsx(Ya,{recommendations:n,prompt:l}),p.jsx(Ic,{subscriptions:Nc(t),recommendations:n})]}):p.jsx("pre",{className:"mt-6 p-4 bg-gray-100 border border-gray-300 rounded-lg whitespace-pre-wrap",children:n}))]})}function Yc(){return p.jsxs("div",{className:"py-12 px-4 sm:px-6 lg:px-8 max-w-5xl mx-auto font-secondary",children:[p.jsx("h1",{className:"text-3xl sm:text-6xl font-extrabold font-primary text-transparent bg-clip-text bg-gradient-to-r from-purple-600 via-pink-600 to-red-600 drop-shadow-lg mb-12 text-center",children:"GPT YouTube Channel Recommender"}),p.jsx("section",{className:"mb-10 p-6 bg-primary-100 rounded-lg shadow-md text-primary-900 font-medium text-center text-lg font-accent",children:"Input your current YouTube subscriptions, and get a curated recommendation list!"}),p.jsx(mo,{}),p.jsx("div",{className:"mt-12",children:p.jsx(Mc,{})})]})}export{Yc as default};
